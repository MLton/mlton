diff --git a/Compat/either/either.sig b/Compat/either/either.sig
new file mode 100644
index 0000000..ac25cbc
--- /dev/null
+++ b/Compat/either/either.sig
@@ -0,0 +1,61 @@
+(* either.sig
+ *
+ * ============================================================================
+ * Copyright (c) 2015 John Reppy (http://cs.uchicago.edu/~jhr)
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *
+ * Reference code for SML Basis Library Proposal 2015-002.
+ *)
+
+signature EITHER =
+  sig
+
+    datatype ('left, 'right) either = INL of 'left | INR of 'right
+
+    val isLeft : ('left, 'right) either -> bool
+    val isRight : ('left, 'right) either -> bool
+
+    val asLeft : ('left, 'right) either -> 'left option
+    val asRight : ('left, 'right) either -> 'right option
+
+    val map  : ('ldom -> 'lrng) * ('rdom -> 'rrng)
+                -> ('ldom, 'rdom) either
+                  -> ('lrng, 'rrng) either
+
+    val app  : ('left -> unit) * ('right -> unit)
+                -> ('left, 'right) either
+                  -> unit
+
+    val fold : ('left * 'b -> 'b) * ('right * 'b -> 'b)
+                -> 'b -> ('left, 'right) either -> 'b
+
+    val proj : ('a, 'a) either -> 'a
+
+    val partition : (('left, 'right) either) list -> ('left list * 'right list)
+
+  (* added 2016-08-10 *)
+    val mapLeft  : ('ldom -> 'lrng) -> ('ldom, 'rdom) either -> ('lrng, 'rdom) either
+    val mapRight : ('rdom -> 'rrng) -> ('ldom, 'rdom) either -> ('ldom, 'rrng) either
+
+    val appLeft  : ('left -> unit) -> ('left, 'right) either -> unit
+    val appRight : ('right -> unit) -> ('left, 'right) either -> unit
+
+  end
diff --git a/Compat/either/either.sml b/Compat/either/either.sml
new file mode 100644
index 0000000..d17e71e
--- /dev/null
+++ b/Compat/either/either.sml
@@ -0,0 +1,75 @@
+(* either.sml
+ *
+ * ============================================================================
+ * Copyright (c) 2015 John Reppy (http://cs.uchicago.edu/~jhr)
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *
+ * Reference code for SML Basis Library Proposal 2015-002.
+ *)
+
+structure Either : EITHER =
+  struct
+
+    datatype ('left, 'right) either = INL of 'left | INR of 'right
+
+    fun isLeft (INL _) = true
+      | isLeft (INR _) = false
+    fun isRight (INL _) = false
+      | isRight (INR _) = true
+
+    fun asLeft (INL x) = SOME x
+      | asLeft (INR _) = NONE
+    fun asRight (INL _) = NONE
+      | asRight (INR x) = SOME x
+
+    fun map (fl, fr) sum = (case sum
+           of INL x => INL(fl x)
+            | INR x => INR(fr x)
+          (* end case *))
+
+    fun mapLeft fl sum = map (fl, fn x => x) sum
+    fun mapRight fr sum = map (fn x => x, fr) sum
+
+    fun app (fl, fr) sum = (case sum
+           of INL x => fl x
+            | INR x => fr x
+          (* end case *))
+
+    fun appLeft fl sum = app (fl, fn x => ()) sum
+    fun appRight fr sum = app (fn x => (), fr) sum
+
+    fun fold (fl, fr) init sum = (case sum
+           of INL x => fl (x, init)
+            | INR x => fr (x, init)
+          (* end case *))
+
+    fun proj (INL x) = x
+      | proj (INR x) = x
+
+    fun partition sums = let
+          fun lp ([], ls, rs) = (List.rev ls, List.rev rs)
+            | lp ((INL x)::sums, ls, rs) = lp (sums, x::ls, rs)
+            | lp ((INR x)::sums, ls, rs) = lp (sums, ls, x::rs)
+          in
+            lp (sums, [], [])
+          end
+
+  end
diff --git a/Compat/either/sources.mlb b/Compat/either/sources.mlb
new file mode 100644
index 0000000..fa5c94b
--- /dev/null
+++ b/Compat/either/sources.mlb
@@ -0,0 +1,8 @@
+local
+  $(SML_LIB)/basis/basis.mlb
+  either.sig
+  either.sml
+in
+  signature EITHER
+  structure Either
+end
diff --git a/Compat/fn/fn.sig b/Compat/fn/fn.sig
new file mode 100644
index 0000000..203c2b5
--- /dev/null
+++ b/Compat/fn/fn.sig
@@ -0,0 +1,42 @@
+(* fn.sig
+ *
+ * ============================================================================
+ * Copyright (c) 2015 John Reppy (http://cs.uchicago.edu/~jhr)
+ * 
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ * 
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ * 
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *
+ * Reference code for SML Basis Library Proposal 2015-005.
+ *)
+
+signature FN =
+  sig
+
+    val id       : 'a -> 'a
+    val const    : 'a -> 'b -> 'a
+    val apply    : ('a -> 'b) * 'a -> 'b
+    val o        : ('b -> 'c) * ('a -> 'b) -> ('a -> 'c)
+    val curry    : ('a * 'b -> 'c) -> ('a -> 'b -> 'c)
+    val uncurry  : ('a -> 'b -> 'c) -> ('a * 'b -> 'c)
+    val flip     : ('a * 'b -> 'c) -> ('b * 'a -> 'c)
+    val repeat   : int -> ('a -> 'a) -> ('a -> 'a)
+    val equal    : ''a -> ''a -> bool
+    val notEqual : ''a -> ''a -> bool
+
+  end
diff --git a/Compat/fn/fn.sml b/Compat/fn/fn.sml
new file mode 100644
index 0000000..fed2d2c
--- /dev/null
+++ b/Compat/fn/fn.sml
@@ -0,0 +1,58 @@
+(* fn.sml
+ *
+ * ============================================================================
+ * Copyright (c) 2015 John Reppy (http://cs.uchicago.edu/~jhr)
+ * 
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ * 
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ * 
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *
+ * Reference code for SML Basis Library Proposal 2015-005.
+ *)
+
+structure Fn : FN =
+  struct
+
+    fun id x = x
+
+    fun const x y = x
+
+    fun apply (f, x) = f x
+
+    val op o = General.o
+
+    fun curry f x y = f(x, y)
+
+    fun uncurry f (x, y) = f x y
+
+    fun flip f (x, y) = f (y, x)
+
+    fun repeat n = if (n < 0)
+	  then raise Domain
+	  else (fn f => let
+	    fun repeatF (0, x) = x
+	      | repeatF (n, x) = repeatF (n-1, f x)
+	    in
+	      fn x => repeatF (n, x)
+	    end)
+
+    fun equal a b = (a = b)
+
+    fun notEqual a b = (a <> b)
+
+  end
diff --git a/Compat/fn/sources.mlb b/Compat/fn/sources.mlb
new file mode 100644
index 0000000..5caeac4
--- /dev/null
+++ b/Compat/fn/sources.mlb
@@ -0,0 +1,8 @@
+local
+  $(SML_LIB)/basis/basis.mlb
+  fn.sig
+  fn.sml
+in
+  signature FN
+  structure Fn
+end
diff --git a/Compat/mono-buffer/mono-buffer.fun b/Compat/mono-buffer/mono-buffer.fun
new file mode 100644
index 0000000..604813c
--- /dev/null
+++ b/Compat/mono-buffer/mono-buffer.fun
@@ -0,0 +1,141 @@
+(* mono-buffer.fun
+ *
+ * ============================================================================
+ * Copyright (c) 2018 John Reppy (http://cs.uchicago.edu/~jhr)
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *
+ * Reference code for SML Basis Library Proposal 2018-001.
+ *
+ * This proposal supersedes 2015-004.
+ *)
+
+functor MonoBufferFn (
+
+    structure V : MONO_VECTOR
+    structure VS : MONO_VECTOR_SLICE
+      where type elem = V.elem and type vector = V.vector
+    structure A : MONO_ARRAY
+      where type elem = V.elem and type vector = V.vector
+    structure AS : MONO_ARRAY_SLICE
+      where type elem = V.elem and type array = A.array
+        and type vector = V.vector and type vector_slice = VS.slice
+    val defaultElem : V.elem
+
+  ) : MONO_BUFFER = struct
+
+    type elem = V.elem
+    type vector = V.vector
+    type slice = VS.slice
+    type array = A.array
+    type array_slice = AS.slice
+
+    datatype buf = BUF of {
+        content : array ref,    (* array for holding content *)
+        len : int ref,          (* current length of content *)
+        initLen : int           (* initial size *)
+      }
+
+  (* default initial size *)
+    val defaultInitLen = 4096
+
+    val maxLen = Int.min(V.maxLen, A.maxLen)
+
+    fun new hint = let
+          val n = if (hint < 0) orelse (V.maxLen < hint)
+                then raise Size
+                else if (hint = 0) then defaultInitLen
+                else hint
+          in
+            BUF{
+                content = ref(A.array(n, defaultElem)),
+                len = ref 0,
+                initLen = n
+              }
+          end
+
+    fun contents (BUF{content=ref arr, len=ref n, ...}) =
+          AS.vector (AS.slice (arr, 0, SOME n))
+
+    fun copy {src=BUF{content=ref arr, len=ref n, ...}, dst, di} =
+          AS.copy {src = AS.slice (arr, 0, SOME n), dst = dst, di = di}
+
+    fun length (BUF{len=ref n, ...}) = n
+
+    fun sub (BUF{content=ref arr, len=ref n, ...}, i) =
+          if (i < 0) orelse (n <= i)
+            then raise Subscript
+            else A.sub(arr, i)
+
+    fun clear (BUF{len, ...}) = (len := 0)
+
+    fun reset (BUF{content, len, initLen}) = (
+          len := 0;
+          if (A.length(!content) <> initLen)
+            then content := A.array(initLen, defaultElem)
+            else ())
+
+  (* ensure that the content array has space for amt elements *)
+    fun ensureCapacity (content, len, amt) = let
+          val curCap = A.length(!content)
+          val ensCap = (len + amt) handle Overflow => maxLen
+          in
+            if (curCap < ensCap)
+              then let
+                val newCap = Int.max(2 * curCap handle Overflow => maxLen, ensCap)
+                val newArr = A.array(newCap, defaultElem)
+                in
+                  AS.copy{dst = newArr, di = 0, src = AS.slice(!content, 0, SOME len)};
+                  content := newArr
+                end
+              else ()
+          end
+
+    fun reserve (_, 0) = ()
+      | reserve (BUF{content, len=ref len, ...}, n) =
+          if (n < 0) then raise Size
+          else ensureCapacity (content, len, n)
+
+    fun add1 (BUF{content, len, ...}, elem) = (
+          ensureCapacity(content, !len, 1);
+          A.update(!content, !len, elem);
+          len := !len + 1)
+
+    fun addVec (BUF{content, len, ...}, vec) = (
+          ensureCapacity(content, !len, V.length vec);
+          A.copyVec{dst = !content, di = !len, src = vec};
+          len := !len + V.length vec)
+
+    fun addSlice (BUF{content, len, ...}, slice) = (
+          ensureCapacity(content, !len, VS.length slice);
+          AS.copyVec{dst = !content, di = !len, src = slice};
+          len := !len + VS.length slice)
+
+    fun addArr (BUF{content, len, ...}, arr) = (
+          ensureCapacity(content, !len, A.length arr);
+          A.copy{dst = !content, di = !len, src = arr};
+          len := !len + A.length arr)
+
+    fun addArrSlice (BUF{content, len, ...}, slice) = (
+          ensureCapacity(content, !len, AS.length slice);
+          AS.copy{dst = !content, di = !len, src = slice};
+          len := !len + AS.length slice)
+
+  end
diff --git a/Compat/mono-buffer/mono-buffer.sig b/Compat/mono-buffer/mono-buffer.sig
new file mode 100644
index 0000000..dce7b83
--- /dev/null
+++ b/Compat/mono-buffer/mono-buffer.sig
@@ -0,0 +1,65 @@
+(* mono-buffer.sig
+ *
+ * ============================================================================
+ * Copyright (c) 2018 John Reppy (http://cs.uchicago.edu/~jhr)
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *
+ * Reference code for SML Basis Library Proposal 2018-001.
+ *
+ * This proposal supersedes 2015-004.
+ *)
+
+signature MONO_BUFFER =
+  sig
+
+    type buf
+
+    type elem
+    type vector
+    type slice
+    type array
+    type array_slice
+
+    val maxLen : int
+
+    val new : int -> buf
+
+    val contents : buf -> vector
+
+    val copy : {src : buf, dst : array, di : int} -> unit
+
+    val length : buf -> int
+
+    val sub : buf * int -> elem
+
+    val clear : buf -> unit
+
+    val reset : buf -> unit
+
+    val reserve : buf * int -> unit
+
+    val add1 : buf * elem -> unit
+    val addVec : buf * vector -> unit
+    val addSlice : buf * slice -> unit
+    val addArr : buf * array -> unit
+    val addArrSlice : buf * array_slice -> unit
+
+  end
diff --git a/Compat/mono-buffer/mono-buffer.sml b/Compat/mono-buffer/mono-buffer.sml
new file mode 100644
index 0000000..5468e29
--- /dev/null
+++ b/Compat/mono-buffer/mono-buffer.sml
@@ -0,0 +1,56 @@
+(* mono-buffer.sml
+ *
+ * ============================================================================
+ * Copyright (c) 2018 John Reppy (http://cs.uchicago.edu/~jhr)
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *
+ * Reference code for SML Basis Library Proposal 2018-001.
+ *
+ * This proposal supersedes 2015-004.
+ *)
+
+structure Word8Buffer :> MONO_BUFFER
+                          where type elem = Word8.word
+                            and type vector = Word8Vector.vector
+                            and type slice = Word8VectorSlice.slice
+                            and type array = Word8Array.array
+                            and type array_slice = Word8ArraySlice.slice
+  = MonoBufferFn (
+      structure V = Word8Vector
+      structure VS = Word8VectorSlice
+      structure A = Word8Array
+      structure AS = Word8ArraySlice
+      val defaultElem : Word8.word = 0w0
+    );
+
+structure CharBuffer :> MONO_BUFFER
+                          where type elem = Char.char
+                            and type vector = CharVector.vector
+                            and type slice = CharVectorSlice.slice
+                            and type array = CharArray.array
+                            and type array_slice = CharArraySlice.slice
+  = MonoBufferFn (
+      structure V = CharVector
+      structure VS = CharVectorSlice
+      structure A = CharArray
+      structure AS = CharArraySlice
+      val defaultElem : Char.char = #"\000"
+    );
diff --git a/Compat/mono-buffer/sources.mlb b/Compat/mono-buffer/sources.mlb
new file mode 100644
index 0000000..9096dd7
--- /dev/null
+++ b/Compat/mono-buffer/sources.mlb
@@ -0,0 +1,10 @@
+local
+   $(SML_LIB)/basis/basis.mlb
+   mono-buffer.sig
+   mono-buffer.fun
+   mono-buffer.sml
+in
+   signature MONO_BUFFER
+   structure Word8Buffer
+   structure CharBuffer
+end
diff --git a/Compat/mono-sequence/mono-array-slice.fun b/Compat/mono-sequence/mono-array-slice.fun
new file mode 100644
index 0000000..20e4b4f
--- /dev/null
+++ b/Compat/mono-sequence/mono-array-slice.fun
@@ -0,0 +1,55 @@
+(* mono-array-slice.fun
+ *
+ * ============================================================================
+ * Copyright (c) 2018 John Reppy (http://cs.uchicago.edu/~jhr)
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *
+ * Reference code for SML Basis Library Proposal 2018-002.
+ *)
+
+functor MonoArraySliceExtFn (MS : MONO_ARRAY_SLICE) : MONO_ARRAY_SLICE_EXT =
+  struct
+
+    open MS
+
+    fun toList v = List.tabulate(length v, fn i => sub(v, i))
+
+    val toVector = vector
+
+    fun triml n s = if (n < length s)
+	  then subslice(s, n, NONE)
+	  else subslice(s, length s, NONE)
+
+    fun trimr n s = if (n < length s)
+	  then subslice(s, 0, SOME(length s - n))
+	  else subslice(s, 0, SOME 0)
+
+    fun splitAt (s, i) = (subslice(s, 0, SOME i), subslice(s, i, NONE))
+
+    fun getVec (s, n) = if (n < length s)
+	  then let
+	    val (s1, s2) = splitAt (s, n)
+	    in
+	      SOME(vector s1, s2)
+	    end
+	  else NONE
+
+  end
diff --git a/Compat/mono-sequence/mono-array-slice.sig b/Compat/mono-sequence/mono-array-slice.sig
new file mode 100644
index 0000000..5b88bc8
--- /dev/null
+++ b/Compat/mono-sequence/mono-array-slice.sig
@@ -0,0 +1,40 @@
+(* mono-array-slice.sig
+ *
+ * ============================================================================
+ * Copyright (c) 2018 John Reppy (http://cs.uchicago.edu/~jhr)
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *
+ * Reference code for SML Basis Library Proposal 2018-002.
+ *)
+
+signature MONO_ARRAY_SLICE_EXT = sig
+
+    include MONO_ARRAY_SLICE
+
+    val toList : slice -> elem list
+    val toVector : slice -> vector
+
+    val triml : int -> slice -> slice
+    val trimr : int -> slice -> slice
+    val splitAt : slice * int -> slice * slice
+    val getVec : slice * int -> (vector * slice) option
+
+  end
diff --git a/Compat/mono-sequence/mono-array.fun b/Compat/mono-sequence/mono-array.fun
new file mode 100644
index 0000000..d1c09c8
--- /dev/null
+++ b/Compat/mono-sequence/mono-array.fun
@@ -0,0 +1,44 @@
+(* mono-array.fun
+ *
+ * ============================================================================
+ * Copyright (c) 2015 John Reppy (http://cs.uchicago.edu/~jhr)
+ * 
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ * 
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ * 
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *
+ * Reference code for SML Basis Library Proposal 2015-003.
+ *)
+
+functor MonoArrayExtFn (
+    structure A : MONO_ARRAY
+    structure V : MONO_VECTOR
+      sharing type A.elem = V.elem
+      sharing type A.vector = V.vector
+  ) : MONO_ARRAY_EXT =
+  struct
+
+    open A
+
+    fun toList arr = List.tabulate(length arr, fn i => sub(arr, i))
+
+    fun fromVector vec = tabulate (V.length vec, fn i => V.sub(vec, i))
+
+    val toVector = vector
+
+  end
diff --git a/Compat/mono-sequence/mono-array.sig b/Compat/mono-sequence/mono-array.sig
new file mode 100644
index 0000000..03175e6
--- /dev/null
+++ b/Compat/mono-sequence/mono-array.sig
@@ -0,0 +1,38 @@
+(* mono-array.sig
+ *
+ * ============================================================================
+ * Copyright (c) 2015 John Reppy (http://cs.uchicago.edu/~jhr)
+ * 
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ * 
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ * 
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *
+ * Reference code for SML Basis Library Proposal 2015-003.
+ *)
+
+signature MONO_ARRAY_EXT =
+  sig
+
+    include MONO_ARRAY
+
+    val toList : array -> elem list
+
+    val fromVector : vector -> array
+    val toVector   : array -> vector
+
+  end
diff --git a/Compat/mono-sequence/mono-vector-slice.fun b/Compat/mono-sequence/mono-vector-slice.fun
new file mode 100644
index 0000000..c56ccf2
--- /dev/null
+++ b/Compat/mono-sequence/mono-vector-slice.fun
@@ -0,0 +1,55 @@
+(* mono-vector-slice.fun
+ *
+ * ============================================================================
+ * Copyright (c) 2018 John Reppy (http://cs.uchicago.edu/~jhr)
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *
+ * Reference code for SML Basis Library Proposal 2018-002.
+ *)
+
+functor MonoVectorSliceExtFn (MS : MONO_VECTOR_SLICE) : MONO_VECTOR_SLICE_EXT =
+  struct
+
+    open MS
+
+    fun toList v = List.tabulate(length v, fn i => sub(v, i))
+
+    val toVector = vector
+
+    fun triml n s = if (n < length s)
+	  then subslice(s, n, NONE)
+	  else subslice(s, length s, NONE)
+
+    fun trimr n s = if (n < length s)
+	  then subslice(s, 0, SOME(length s - n))
+	  else subslice(s, 0, SOME 0)
+
+    fun splitAt (s, i) = (subslice(s, 0, SOME i), subslice(s, i, NONE))
+
+    fun getVec (s, n) = if (n < length s)
+	  then let
+	    val (s1, s2) = splitAt (s, n)
+	    in
+	      SOME(vector s1, s2)
+	    end
+	  else NONE
+
+  end
diff --git a/Compat/mono-sequence/mono-vector-slice.sig b/Compat/mono-sequence/mono-vector-slice.sig
new file mode 100644
index 0000000..18bf03e
--- /dev/null
+++ b/Compat/mono-sequence/mono-vector-slice.sig
@@ -0,0 +1,38 @@
+(* mono-vector-slice.sig
+ *
+ * ============================================================================
+ * Copyright (c) 2018 John Reppy (http://cs.uchicago.edu/~jhr)
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *)
+
+signature MONO_VECTOR_SLICE_EXT = sig
+
+    include MONO_VECTOR_SLICE
+
+    val toList : slice -> elem list
+    val toVector : slice -> vector
+
+    val triml : int -> slice -> slice
+    val trimr : int -> slice -> slice
+    val splitAt : slice * int -> slice * slice
+    val getVec : slice * int -> (vector * slice) option
+
+  end
diff --git a/Compat/mono-sequence/mono-vector-slice.sml b/Compat/mono-sequence/mono-vector-slice.sml
new file mode 100644
index 0000000..fe16557
--- /dev/null
+++ b/Compat/mono-sequence/mono-vector-slice.sml
@@ -0,0 +1,2 @@
+structure Word8VectorSlice : MONO_VECTOR_SLICE_EXT
+  = MonoVectorSliceExtFn (Word8VectorSlice)
diff --git a/Compat/mono-sequence/mono-vector.fun b/Compat/mono-sequence/mono-vector.fun
new file mode 100644
index 0000000..67623f6
--- /dev/null
+++ b/Compat/mono-sequence/mono-vector.fun
@@ -0,0 +1,39 @@
+(* mono-vector.fun
+ *
+ * ============================================================================
+ * Copyright (c) 2015 John Reppy (http://cs.uchicago.edu/~jhr)
+ * 
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ * 
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ * 
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *
+ * Reference code for SML Basis Library Proposal 2015-003.
+ *)
+
+functor MonoVectorExtFn (V : MONO_VECTOR) : MONO_VECTOR_EXT =
+  struct
+
+    open V
+
+    fun toList v = List.tabulate(length v, fn i => sub(v, i))
+
+    fun append (v, x) = concat[v, fromList[x]]
+
+    fun prepend (x, v) = concat[fromList[x], v]
+
+  end
diff --git a/Compat/mono-sequence/mono-vector.sig b/Compat/mono-sequence/mono-vector.sig
new file mode 100644
index 0000000..921ed80
--- /dev/null
+++ b/Compat/mono-sequence/mono-vector.sig
@@ -0,0 +1,38 @@
+(* mono-vector.sig
+ *
+ * ============================================================================
+ * Copyright (c) 2015 John Reppy (http://cs.uchicago.edu/~jhr)
+ * 
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ * 
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ * 
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ * ============================================================================
+ *
+ * Reference code for SML Basis Library Proposal 2015-003.
+ *)
+
+signature MONO_VECTOR_EXT =
+  sig
+
+    include MONO_VECTOR
+
+    val toList : vector -> elem list
+
+    val append  : vector * elem -> vector
+    val prepend : elem * vector -> vector
+
+  end
diff --git a/Compat/mono-sequence/sources.mlb b/Compat/mono-sequence/sources.mlb
new file mode 100644
index 0000000..30dff8a
--- /dev/null
+++ b/Compat/mono-sequence/sources.mlb
@@ -0,0 +1,23 @@
+local
+  $(SML_LIB)/basis/basis.mlb
+  mono-vector.sig
+  mono-vector.fun
+  mono-vector-slice.sig
+  mono-vector-slice.fun
+  mono-array.sig
+  mono-array.fun
+  mono-array-slice.sig
+  mono-array-slice.fun
+
+  mono-vector-slice.sml
+in
+  signature MONO_VECTOR_EXT
+  functor MonoVectorExtFn
+  signature MONO_VECTOR_SLICE_EXT
+  functor MonoVectorSliceExtFn
+  functor MonoArrayExtFn
+  signature MONO_ARRAY_EXT
+  signature MONO_ARRAY_SLICE_EXT
+  functor MonoArraySliceExtFn
+  structure Word8VectorSlice
+end
diff --git a/Controls/controls-lib.mlb b/Controls/controls-lib.mlb
new file mode 100644
index 0000000..3a452a1
--- /dev/null
+++ b/Controls/controls-lib.mlb
@@ -0,0 +1,300 @@
+
+ann
+  "nonexhaustiveBind warn" "nonexhaustiveMatch warn"
+  "redundantBind warn" "redundantMatch warn"
+  "sequenceNonUnit ignore"
+  "warnUnused false" "forceUsed"
+in
+
+local
+  basis l11 =
+    bas
+      (* $/basis.cm ====> *) $(SML_LIB)/basis/basis.mlb $(SML_LIB)/basis/sml-nj.mlb
+    end
+  basis l4 =
+    bas
+      (* $/smlnj-lib.cm ====> *) $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
+    end
+in
+local
+   $(SML_LIB)/basis/pervasive.mlb
+   local
+      open l4
+   in
+      structure gs_0 = AtomTable
+   end
+   local
+      open l4
+   in
+      structure gs_1 = Atom
+   end
+   local
+      open l11
+   in
+      structure gs_2 = List
+   end
+   local
+      open l4
+   in
+      structure gs_3 = ListMergeSort
+   end
+   local
+      open l11
+   in
+      structure gs_4 = Char
+      structure gs_5 = CharArray
+      structure gs_6 = CharVector
+      structure gs_7 = FixedInt
+      structure gs_8 = General
+      structure gs_9 = Int
+      structure gs_10 = Int32
+      structure gs_11 = Int64
+      structure gs_12 = IntInf
+      structure gs_13 = LargeInt
+      structure gs_14 = LargeReal
+      structure gs_15 = LargeWord
+      structure gs_16 = OS
+      structure gs_17 = Position
+      structure gs_18 = Real
+      structure gs_19 = Real64
+      structure gs_20 = RealArray
+      structure gs_21 = RealArraySlice
+      structure gs_22 = RealVector
+      structure gs_23 = RealVectorSlice
+      structure gs_24 = SMLofNJ
+      structure gs_25 = Socket
+      structure gs_26 = String
+      structure gs_27 = Substring
+      structure gs_28 = SysWord
+      structure gs_29 = Time
+      structure gs_30 = Word
+      structure gs_31 = Word32
+      structure gs_32 = Word64
+      structure gs_33 = Word8
+   end
+   local
+      open l11
+   in
+      structure gs_34 = Option
+   end
+   local
+      open l4
+   in
+      structure gs_35 = GetOpt
+   end
+   local
+      structure GetOpt = gs_35
+      controls-sig.sml
+   in
+      signature gs_36 = CONTROLS
+   end
+   local
+      structure Atom = gs_1
+      structure AtomTable = gs_0
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_2
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      control-reps.sml
+   in
+      structure gs_37 = ControlReps
+   end
+   local
+      structure Atom = gs_1
+      signature CONTROLS = gs_36
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure ControlReps = gs_37
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure GetOpt = gs_35
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_2
+      structure OS = gs_16
+      structure Option = gs_34
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      controls.sml
+   in
+      structure gs_38 = Controls
+   end
+   local
+      structure Atom = gs_1
+      structure Controls = gs_38
+      control-set-sig.sml
+   in
+      signature gs_39 = CONTROL_SET
+   end
+   local
+      structure AtomTable = gs_0
+      signature CONTROL_SET = gs_39
+      structure ControlReps = gs_37
+      structure Controls = gs_38
+      structure ListMergeSort = gs_3
+      structure Option = gs_34
+      control-set.sml
+   in
+      structure gs_40 = ControlSet
+   end
+   local
+      structure ControlSet = gs_40
+      structure Controls = gs_38
+      control-registry-sig.sml
+   in
+      signature gs_41 = CONTROL_REGISTRY
+   end
+   local
+      structure Atom = gs_1
+      structure AtomTable = gs_0
+      signature CONTROL_REGISTRY = gs_41
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure ControlReps = gs_37
+      structure ControlSet = gs_40
+      structure Controls = gs_38
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_2
+      structure ListMergeSort = gs_3
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      control-registry.sml
+   in
+      structure gs_42 = ControlRegistry
+   end
+   local
+      structure Controls = gs_38
+      control-util-sig.sml
+   in
+      signature gs_43 = CONTROL_UTIL
+   end
+   local
+      open l11
+   in
+      structure gs_44 = Bool
+   end
+   local
+      structure Bool = gs_44
+      signature CONTROL_UTIL = gs_43
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure Controls = gs_38
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_2
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      control-util.sml
+   in
+      structure gs_45 = ControlUtil
+   end
+in
+   signature CONTROLS = gs_36
+   signature CONTROL_REGISTRY = gs_41
+   signature CONTROL_SET = gs_39
+   signature CONTROL_UTIL = gs_43
+   structure ControlRegistry = gs_42
+   structure ControlSet = gs_40
+   structure ControlUtil = gs_45
+   structure Controls = gs_38
+end
+end
+
+end
diff --git a/HTML/html-lib.mlb b/HTML/html-lib.mlb
new file mode 100644
index 0000000..132b093
--- /dev/null
+++ b/HTML/html-lib.mlb
@@ -0,0 +1,476 @@
+
+ann
+  "nonexhaustiveBind warn" "nonexhaustiveMatch warn"
+  "redundantBind warn" "redundantMatch warn"
+  "sequenceNonUnit ignore"
+  "warnUnused false" "forceUsed"
+  "allowOrPats true" "allowVectorExpsAndPats true"
+in
+
+local
+  basis l41 =
+    bas
+      (* $/basis.cm ====> *) $(SML_LIB)/basis/basis.mlb $(SML_LIB)/basis/sml-nj.mlb $(SML_LIB)/basis/unsafe.mlb
+    end
+  basis l8 =
+    bas
+      (* $/smlnj-lib.cm ====> *) $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
+    end
+  basis l69 =
+    bas
+      (* $/ml-yacc-lib.cm ====> *) $(SML_LIB)/mlyacc-lib/mlyacc-lib.mlb
+    end
+in
+local
+   $(SML_LIB)/basis/pervasive.mlb
+   local
+      html-error-sig.sml
+   in
+      signature gs_0 = HTML_ERROR
+   end
+   local
+      open l8
+   in
+      structure gs_1 = Format
+   end
+   local
+      open l41
+   in
+      structure gs_2 = Char
+      structure gs_3 = CharArray
+      structure gs_4 = CharVector
+      structure gs_5 = FixedInt
+      structure gs_6 = General
+      structure gs_7 = Int
+      structure gs_8 = Int32
+      structure gs_9 = Int64
+      structure gs_10 = IntInf
+      structure gs_11 = LargeInt
+      structure gs_12 = LargeReal
+      structure gs_13 = LargeWord
+      structure gs_14 = OS
+      structure gs_15 = Position
+      structure gs_16 = Real
+      structure gs_17 = Real64
+      structure gs_18 = RealArray
+      structure gs_19 = RealArraySlice
+      structure gs_20 = RealVector
+      structure gs_21 = RealVectorSlice
+      structure gs_22 = SMLofNJ
+      structure gs_23 = Socket
+      structure gs_24 = String
+      structure gs_25 = Substring
+      structure gs_26 = SysWord
+      structure gs_27 = Time
+      structure gs_28 = Word
+      structure gs_29 = Word32
+      structure gs_30 = Word64
+      structure gs_31 = Word8
+   end
+   local
+      open l41
+   in
+      structure gs_32 = List
+   end
+   local
+      open l8
+   in
+      structure gs_33 = ListFormat
+   end
+   local
+      html-sig.sml
+   in
+      signature gs_34 = HTML
+   end
+   local
+      structure Char = gs_2
+      structure CharArray = gs_3
+      structure CharVector = gs_4
+      structure FixedInt = gs_5
+      structure General = gs_6
+      signature HTML = gs_34
+      structure Int = gs_7
+      structure Int32 = gs_8
+      structure Int64 = gs_9
+      structure IntInf = gs_10
+      structure LargeInt = gs_11
+      structure LargeReal = gs_12
+      structure LargeWord = gs_13
+      structure List = gs_32
+      structure OS = gs_14
+      structure Position = gs_15
+      structure Real = gs_16
+      structure Real64 = gs_17
+      structure RealArray = gs_18
+      structure RealArraySlice = gs_19
+      structure RealVector = gs_20
+      structure RealVectorSlice = gs_21
+      structure SMLofNJ = gs_22
+      structure Socket = gs_23
+      structure String = gs_24
+      structure Substring = gs_25
+      structure SysWord = gs_26
+      structure Time = gs_27
+      structure Word = gs_28
+      structure Word32 = gs_29
+      structure Word64 = gs_30
+      structure Word8 = gs_31
+      html.sml
+   in
+      structure gs_35 = HTML
+   end
+   local
+      structure Char = gs_2
+      structure CharArray = gs_3
+      structure CharVector = gs_4
+      structure FixedInt = gs_5
+      structure Format = gs_1
+      structure General = gs_6
+      structure HTML = gs_35
+      structure Int = gs_7
+      structure Int32 = gs_8
+      structure Int64 = gs_9
+      structure IntInf = gs_10
+      structure LargeInt = gs_11
+      structure LargeReal = gs_12
+      structure LargeWord = gs_13
+      structure List = gs_32
+      structure ListFormat = gs_33
+      structure OS = gs_14
+      structure Position = gs_15
+      structure Real = gs_16
+      structure Real64 = gs_17
+      structure RealArray = gs_18
+      structure RealArraySlice = gs_19
+      structure RealVector = gs_20
+      structure RealVectorSlice = gs_21
+      structure SMLofNJ = gs_22
+      structure Socket = gs_23
+      structure String = gs_24
+      structure Substring = gs_25
+      structure SysWord = gs_26
+      structure Time = gs_27
+      structure Word = gs_28
+      structure Word32 = gs_29
+      structure Word64 = gs_30
+      structure Word8 = gs_31
+      pr-html.sml
+   in
+      structure gs_36 = PrHTML
+   end
+   local
+      structure HTML = gs_35
+      make-html.sml
+   in
+      structure gs_37 = MakeHTML
+   end
+   local
+      structure HTML = gs_35
+      html-defaults.sml
+   in
+      structure gs_38 = HTMLDefaults
+   end
+   local
+      open l69
+   in
+      functor gs_39 = Join
+      functor gs_40 = JoinWithArg
+   end
+   local
+      open l69
+   in
+      structure gs_41 = LrParser
+   end
+   local
+      open l41
+   in
+      structure gs_42 = TextIO
+   end
+   local
+      structure Format = gs_1
+      structure HTML = gs_35
+      signature HTML_ERROR = gs_0
+      structure List = gs_32
+      check-html-fn.sml
+   in
+      functor gs_43 = CheckHTMLFn
+   end
+   local
+      open l41
+   in
+      structure gs_44 = IO
+   end
+   local
+      open l41
+   in
+      structure gs_45 = TextPrimIO
+   end
+   local
+      open l41
+   in
+      structure gs_46 = Vector
+   end
+   local
+      open l8
+   in
+      functor gs_47 = HashTableFn
+   end
+   local
+      open l8
+   in
+      structure gs_48 = HashString
+   end
+   local
+      html-attr-vals.sml
+   in
+      structure gs_49 = HTMLAttrVals
+   end
+   local
+      structure HTML = gs_35
+      structure HTMLAttrVals = gs_49
+      html-attrs-sig.sml
+   in
+      signature gs_50 = HTML_ATTRS
+   end
+   local
+      open l69
+   in
+      signature gs_51 = ARG_LEXER
+      signature gs_52 = ARG_PARSER
+      signature gs_53 = LEXER
+      signature gs_54 = LR_PARSER
+      signature gs_55 = LR_TABLE
+      signature gs_56 = PARSER
+      signature gs_57 = PARSER_DATA
+      signature gs_58 = STREAM
+      signature gs_59 = TOKEN
+   end
+   local
+      signature ARG_LEXER = gs_51
+      signature ARG_PARSER = gs_52
+      structure HTMLAttrVals = gs_49
+      signature LEXER = gs_53
+      signature LR_PARSER = gs_54
+      signature LR_TABLE = gs_55
+      signature PARSER = gs_56
+      signature PARSER_DATA = gs_57
+      signature STREAM = gs_58
+      signature TOKEN = gs_59
+      html-gram.sig
+   in
+      signature gs_60 = HTML_LRVALS
+      signature gs_61 = HTML_TOKENS
+   end
+   local
+      structure Char = gs_2
+      structure CharArray = gs_3
+      structure CharVector = gs_4
+      structure FixedInt = gs_5
+      structure General = gs_6
+      signature HTML_ATTRS = gs_50
+      signature HTML_ERROR = gs_0
+      signature HTML_LRVALS = gs_60
+      signature HTML_TOKENS = gs_61
+      structure HashString = gs_48
+      functor HashTableFn = gs_47
+      structure Int = gs_7
+      structure Int32 = gs_8
+      structure Int64 = gs_9
+      structure IntInf = gs_10
+      structure LargeInt = gs_11
+      structure LargeReal = gs_12
+      structure LargeWord = gs_13
+      structure List = gs_32
+      structure OS = gs_14
+      structure Position = gs_15
+      structure Real = gs_16
+      structure Real64 = gs_17
+      structure RealArray = gs_18
+      structure RealArraySlice = gs_19
+      structure RealVector = gs_20
+      structure RealVectorSlice = gs_21
+      structure SMLofNJ = gs_22
+      structure Socket = gs_23
+      structure String = gs_24
+      structure Substring = gs_25
+      structure SysWord = gs_26
+      structure Time = gs_27
+      structure Word = gs_28
+      structure Word32 = gs_29
+      structure Word64 = gs_30
+      structure Word8 = gs_31
+      html-elements-fn.sml
+   in
+      functor gs_62 = HTMLElementsFn
+   end
+   local
+      structure Char = gs_2
+      structure CharArray = gs_3
+      structure CharVector = gs_4
+      structure FixedInt = gs_5
+      structure General = gs_6
+      functor HTMLElementsFn = gs_62
+      signature HTML_ATTRS = gs_50
+      signature HTML_ERROR = gs_0
+      signature HTML_LRVALS = gs_60
+      signature HTML_TOKENS = gs_61
+      structure IO = gs_44
+      structure Int = gs_7
+      structure Int32 = gs_8
+      structure Int64 = gs_9
+      structure IntInf = gs_10
+      structure LargeInt = gs_11
+      structure LargeReal = gs_12
+      structure LargeWord = gs_13
+      structure List = gs_32
+      structure OS = gs_14
+      structure Position = gs_15
+      structure Real = gs_16
+      structure Real64 = gs_17
+      structure RealArray = gs_18
+      structure RealArraySlice = gs_19
+      structure RealVector = gs_20
+      structure RealVectorSlice = gs_21
+      structure SMLofNJ = gs_22
+      structure Socket = gs_23
+      structure String = gs_24
+      structure Substring = gs_25
+      structure SysWord = gs_26
+      structure TextIO = gs_42
+      structure TextPrimIO = gs_45
+      structure Time = gs_27
+      structure Vector = gs_46
+      structure Word = gs_28
+      structure Word32 = gs_29
+      structure Word64 = gs_30
+      structure Word8 = gs_31
+      html-lex.sml
+   in
+      functor gs_63 = HTMLLexFn
+   end
+   local
+      open l41
+   in
+      structure gs_64 = Array
+   end
+   local
+      signature ARG_LEXER = gs_51
+      signature ARG_PARSER = gs_52
+      structure Array = gs_64
+      structure Char = gs_2
+      structure CharArray = gs_3
+      structure CharVector = gs_4
+      structure FixedInt = gs_5
+      structure General = gs_6
+      structure HTML = gs_35
+      structure HTMLAttrVals = gs_49
+      signature HTML_ATTRS = gs_50
+      signature HTML_LRVALS = gs_60
+      signature HTML_TOKENS = gs_61
+      structure Int = gs_7
+      structure Int32 = gs_8
+      structure Int64 = gs_9
+      structure IntInf = gs_10
+      signature LEXER = gs_53
+      signature LR_PARSER = gs_54
+      signature LR_TABLE = gs_55
+      structure LargeInt = gs_11
+      structure LargeReal = gs_12
+      structure LargeWord = gs_13
+      structure List = gs_32
+      structure OS = gs_14
+      signature PARSER = gs_56
+      signature PARSER_DATA = gs_57
+      structure Position = gs_15
+      structure Real = gs_16
+      structure Real64 = gs_17
+      structure RealArray = gs_18
+      structure RealArraySlice = gs_19
+      structure RealVector = gs_20
+      structure RealVectorSlice = gs_21
+      structure SMLofNJ = gs_22
+      signature STREAM = gs_58
+      structure Socket = gs_23
+      structure String = gs_24
+      structure Substring = gs_25
+      structure SysWord = gs_26
+      signature TOKEN = gs_59
+      structure Time = gs_27
+      structure Word = gs_28
+      structure Word32 = gs_29
+      structure Word64 = gs_30
+      structure Word8 = gs_31
+      html-gram.sml
+   in
+      functor gs_65 = HTMLLrValsFn
+   end
+   local
+      structure Array = gs_64
+      structure Char = gs_2
+      structure CharArray = gs_3
+      structure CharVector = gs_4
+      structure FixedInt = gs_5
+      structure General = gs_6
+      structure HTML = gs_35
+      structure HTMLAttrVals = gs_49
+      signature HTML_ATTRS = gs_50
+      signature HTML_ERROR = gs_0
+      structure HashString = gs_48
+      functor HashTableFn = gs_47
+      structure Int = gs_7
+      structure Int32 = gs_8
+      structure Int64 = gs_9
+      structure IntInf = gs_10
+      structure LargeInt = gs_11
+      structure LargeReal = gs_12
+      structure LargeWord = gs_13
+      structure List = gs_32
+      structure OS = gs_14
+      structure Position = gs_15
+      structure Real = gs_16
+      structure Real64 = gs_17
+      structure RealArray = gs_18
+      structure RealArraySlice = gs_19
+      structure RealVector = gs_20
+      structure RealVectorSlice = gs_21
+      structure SMLofNJ = gs_22
+      structure Socket = gs_23
+      structure String = gs_24
+      structure Substring = gs_25
+      structure SysWord = gs_26
+      structure Time = gs_27
+      structure Word = gs_28
+      structure Word32 = gs_29
+      structure Word64 = gs_30
+      structure Word8 = gs_31
+      html-attrs-fn.sml
+   in
+      functor gs_66 = HTMLAttrsFn
+   end
+   local
+      functor CheckHTMLFn = gs_43
+      structure HTML = gs_35
+      functor HTMLAttrsFn = gs_66
+      functor HTMLLexFn = gs_63
+      functor HTMLLrValsFn = gs_65
+      signature HTML_ERROR = gs_0
+      functor Join = gs_39
+      functor JoinWithArg = gs_40
+      structure LrParser = gs_41
+      structure TextIO = gs_42
+      html-parser-fn.sml
+   in
+      functor gs_67 = HTMLParserFn
+   end
+in
+   signature HTML = gs_34
+   structure HTML = gs_35
+   structure HTMLDefaults = gs_38
+   functor HTMLParserFn = gs_67
+   signature HTML_ERROR = gs_0
+   structure MakeHTML = gs_37
+   structure PrHTML = gs_36
+end
+end
+
+end
diff --git a/HTML4/html4-lib.cm b/HTML4/html4-lib.cm
index 7736208..4d03e99 100644
--- a/HTML4/html4-lib.cm
+++ b/HTML4/html4-lib.cm
@@ -23,6 +23,9 @@ is
   $/smlnj-lib.cm
   $/ml-lpt-lib.cm
 
+  $/pp-lib.cm
+  pp-init.sml
+
 #if defined(NO_PLUGINS)
   html4.g.sml
   html4.l.sml
diff --git a/HTML4/html4-lib.mlb b/HTML4/html4-lib.mlb
new file mode 100644
index 0000000..7f5a328
--- /dev/null
+++ b/HTML4/html4-lib.mlb
@@ -0,0 +1,569 @@
+
+ann
+  "nonexhaustiveBind ignore" "nonexhaustiveMatch ignore"
+  "redundantBind warn" "redundantMatch warn"
+  "sequenceNonUnit ignore"
+  "warnUnused false" "forceUsed"
+in
+
+local
+  basis l14 =
+    bas
+      (* $/basis.cm ====> *) $(SML_LIB)/basis/basis.mlb $(SML_LIB)/basis/sml-nj.mlb
+    end
+  basis l4 =
+    bas
+      (* $/smlnj-lib.cm ====> *) $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
+    end
+  basis l53 =
+    bas
+      (* $/ml-lpt-lib.cm ====> *) $(SML_LIB)/mllpt-lib/mllpt-lib.mlb
+    end
+in
+local
+   $(SML_LIB)/basis/pervasive.mlb
+   local
+      open l4
+   in
+      signature gs_0 = ORD_MAP
+   end
+   local
+      open l4
+   in
+      functor gs_1 = RedBlackMapFn
+   end
+   local
+      open l4
+   in
+      structure gs_2 = Atom
+   end
+   local
+      open l14
+   in
+      structure gs_3 = CharVectorSlice
+   end
+   local
+      open l14
+   in
+      structure gs_4 = TextIO
+   end
+   local
+      open l14
+   in
+      structure gs_5 = Char
+      structure gs_6 = CharArray
+      structure gs_7 = CharVector
+      structure gs_8 = FixedInt
+      structure gs_9 = General
+      structure gs_10 = Int
+      structure gs_11 = Int32
+      structure gs_12 = Int64
+      structure gs_13 = IntInf
+      structure gs_14 = LargeInt
+      structure gs_15 = LargeReal
+      structure gs_16 = LargeWord
+      structure gs_17 = OS
+      structure gs_18 = Position
+      structure gs_19 = Real
+      structure gs_20 = Real64
+      structure gs_21 = RealArray
+      structure gs_22 = RealArraySlice
+      structure gs_23 = RealVector
+      structure gs_24 = RealVectorSlice
+      structure gs_25 = SMLofNJ
+      structure gs_26 = Socket
+      structure gs_27 = String
+      structure gs_28 = Substring
+      structure gs_29 = SysWord
+      structure gs_30 = Time
+      structure gs_31 = Word
+      structure gs_32 = Word32
+      structure gs_33 = Word64
+      structure gs_34 = Word8
+   end
+   local
+      open l53
+   in
+      structure gs_35 = AntlrStreamPos
+   end
+   local
+      open l53
+   in
+      functor gs_36 = AntlrErrHandler
+   end
+   local
+      open l14
+   in
+      structure gs_37 = List
+   end
+   local
+      open l53
+   in
+      signature gs_38 = ANTLR_LEXER
+   end
+   local
+      structure Atom = gs_2
+      structure Char = gs_5
+      structure CharArray = gs_6
+      structure CharVector = gs_7
+      structure FixedInt = gs_8
+      structure General = gs_9
+      structure Int = gs_10
+      structure Int32 = gs_11
+      structure Int64 = gs_12
+      structure IntInf = gs_13
+      structure LargeInt = gs_14
+      structure LargeReal = gs_15
+      structure LargeWord = gs_16
+      structure OS = gs_17
+      structure Position = gs_18
+      structure Real = gs_19
+      structure Real64 = gs_20
+      structure RealArray = gs_21
+      structure RealArraySlice = gs_22
+      structure RealVector = gs_23
+      structure RealVectorSlice = gs_24
+      structure SMLofNJ = gs_25
+      structure Socket = gs_26
+      structure String = gs_27
+      structure Substring = gs_28
+      structure SysWord = gs_29
+      structure Time = gs_30
+      structure Word = gs_31
+      structure Word32 = gs_32
+      structure Word64 = gs_33
+      structure Word8 = gs_34
+      html4-utils.sml
+   in
+      structure gs_39 = HTML4Utils
+   end
+   local
+      signature ANTLR_LEXER = gs_38
+      functor AntlrErrHandler = gs_36
+      structure Atom = gs_2
+      structure Char = gs_5
+      structure CharArray = gs_6
+      structure CharVector = gs_7
+      structure FixedInt = gs_8
+      structure General = gs_9
+      structure HTML4Utils = gs_39
+      structure Int = gs_10
+      structure Int32 = gs_11
+      structure Int64 = gs_12
+      structure IntInf = gs_13
+      structure LargeInt = gs_14
+      structure LargeReal = gs_15
+      structure LargeWord = gs_16
+      structure List = gs_37
+      structure OS = gs_17
+      structure Position = gs_18
+      structure Real = gs_19
+      structure Real64 = gs_20
+      structure RealArray = gs_21
+      structure RealArraySlice = gs_22
+      structure RealVector = gs_23
+      structure RealVectorSlice = gs_24
+      structure SMLofNJ = gs_25
+      structure Socket = gs_26
+      structure String = gs_27
+      structure Substring = gs_28
+      structure SysWord = gs_29
+      structure Time = gs_30
+      structure Word = gs_31
+      structure Word32 = gs_32
+      structure Word64 = gs_33
+      structure Word8 = gs_34
+      html4.g.sml
+   in
+      functor gs_40 = HTML4ParseFn
+      structure gs_41 = HTML4Tokens
+   end
+   local
+      signature ANTLR_LEXER = gs_38
+      functor AntlrErrHandler = gs_36
+      structure Atom = gs_2
+      structure Char = gs_5
+      structure CharArray = gs_6
+      structure CharVector = gs_7
+      structure FixedInt = gs_8
+      structure General = gs_9
+      structure Int = gs_10
+      structure Int32 = gs_11
+      structure Int64 = gs_12
+      structure IntInf = gs_13
+      structure LargeInt = gs_14
+      structure LargeReal = gs_15
+      structure LargeWord = gs_16
+      structure List = gs_37
+      structure OS = gs_17
+      structure Position = gs_18
+      structure Real = gs_19
+      structure Real64 = gs_20
+      structure RealArray = gs_21
+      structure RealArraySlice = gs_22
+      structure RealVector = gs_23
+      structure RealVectorSlice = gs_24
+      structure SMLofNJ = gs_25
+      structure Socket = gs_26
+      structure String = gs_27
+      structure Substring = gs_28
+      structure SysWord = gs_29
+      structure Time = gs_30
+      structure Word = gs_31
+      structure Word32 = gs_32
+      structure Word64 = gs_33
+      structure Word8 = gs_34
+      html4-attr.g.sml
+   in
+      functor gs_42 = HTML4AttrParseFn
+      structure gs_43 = HTML4AttrTokens
+   end
+   local
+      open l14
+   in
+      structure gs_44 = Vector
+   end
+   local
+      open l53
+   in
+      structure gs_45 = UTF8
+   end
+   local
+      open l53
+   in
+      structure gs_46 = ULexBuffer
+   end
+   local
+      structure AntlrStreamPos = gs_35
+      structure Atom = gs_2
+      structure Char = gs_5
+      structure CharArray = gs_6
+      structure CharVector = gs_7
+      structure FixedInt = gs_8
+      structure General = gs_9
+      functor HTML4AttrParseFn = gs_42
+      structure HTML4AttrTokens = gs_43
+      structure Int = gs_10
+      structure Int32 = gs_11
+      structure Int64 = gs_12
+      structure IntInf = gs_13
+      structure LargeInt = gs_14
+      structure LargeReal = gs_15
+      structure LargeWord = gs_16
+      structure List = gs_37
+      structure OS = gs_17
+      structure Position = gs_18
+      structure Real = gs_19
+      structure Real64 = gs_20
+      structure RealArray = gs_21
+      structure RealArraySlice = gs_22
+      structure RealVector = gs_23
+      structure RealVectorSlice = gs_24
+      structure SMLofNJ = gs_25
+      structure Socket = gs_26
+      structure String = gs_27
+      structure Substring = gs_28
+      structure SysWord = gs_29
+      structure TextIO = gs_4
+      structure Time = gs_30
+      structure ULexBuffer = gs_46
+      structure UTF8 = gs_45
+      structure Vector = gs_44
+      structure Word = gs_31
+      structure Word32 = gs_32
+      structure Word64 = gs_33
+      structure Word8 = gs_34
+      html4-attr.l.sml
+   in
+      structure gs_47 = HTML4AttrLexer
+   end
+   local
+      structure AntlrStreamPos = gs_35
+      structure Atom = gs_2
+      structure Char = gs_5
+      structure CharArray = gs_6
+      structure CharVector = gs_7
+      structure CharVectorSlice = gs_3
+      structure FixedInt = gs_8
+      structure General = gs_9
+      structure HTML4AttrLexer = gs_47
+      functor HTML4AttrParseFn = gs_42
+      structure HTML4AttrTokens = gs_43
+      functor HTML4ParseFn = gs_40
+      structure HTML4Tokens = gs_41
+      structure HTML4Utils = gs_39
+      structure Int = gs_10
+      structure Int32 = gs_11
+      structure Int64 = gs_12
+      structure IntInf = gs_13
+      structure LargeInt = gs_14
+      structure LargeReal = gs_15
+      structure LargeWord = gs_16
+      signature ORD_MAP = gs_0
+      structure OS = gs_17
+      structure Position = gs_18
+      structure Real = gs_19
+      structure Real64 = gs_20
+      structure RealArray = gs_21
+      structure RealArraySlice = gs_22
+      structure RealVector = gs_23
+      structure RealVectorSlice = gs_24
+      functor RedBlackMapFn = gs_1
+      structure SMLofNJ = gs_25
+      structure Socket = gs_26
+      structure String = gs_27
+      structure Substring = gs_28
+      structure SysWord = gs_29
+      structure TextIO = gs_4
+      structure Time = gs_30
+      structure Word = gs_31
+      structure Word32 = gs_32
+      structure Word64 = gs_33
+      structure Word8 = gs_34
+      html4-token-utils.sml
+   in
+      structure gs_48 = HTML4TokenUtils
+   end
+   local
+      structure Atom = gs_2
+      structure Char = gs_5
+      structure CharArray = gs_6
+      structure CharVector = gs_7
+      structure FixedInt = gs_8
+      structure General = gs_9
+      structure Int = gs_10
+      structure Int32 = gs_11
+      structure Int64 = gs_12
+      structure IntInf = gs_13
+      structure LargeInt = gs_14
+      structure LargeReal = gs_15
+      structure LargeWord = gs_16
+      structure OS = gs_17
+      structure Position = gs_18
+      structure Real = gs_19
+      structure Real64 = gs_20
+      structure RealArray = gs_21
+      structure RealArraySlice = gs_22
+      structure RealVector = gs_23
+      structure RealVectorSlice = gs_24
+      structure SMLofNJ = gs_25
+      structure Socket = gs_26
+      structure String = gs_27
+      structure Substring = gs_28
+      structure SysWord = gs_29
+      structure Time = gs_30
+      structure Word = gs_31
+      structure Word32 = gs_32
+      structure Word64 = gs_33
+      structure Word8 = gs_34
+      html4.sig
+   in
+      signature gs_49 = HTML4
+   end
+   local
+      structure Atom = gs_2
+      structure Char = gs_5
+      structure CharArray = gs_6
+      structure CharVector = gs_7
+      structure FixedInt = gs_8
+      structure General = gs_9
+      signature HTML4 = gs_49
+      structure Int = gs_10
+      structure Int32 = gs_11
+      structure Int64 = gs_12
+      structure IntInf = gs_13
+      structure LargeInt = gs_14
+      structure LargeReal = gs_15
+      structure LargeWord = gs_16
+      structure OS = gs_17
+      structure Position = gs_18
+      structure Real = gs_19
+      structure Real64 = gs_20
+      structure RealArray = gs_21
+      structure RealArraySlice = gs_22
+      structure RealVector = gs_23
+      structure RealVectorSlice = gs_24
+      structure SMLofNJ = gs_25
+      structure Socket = gs_26
+      structure String = gs_27
+      structure Substring = gs_28
+      structure SysWord = gs_29
+      structure Time = gs_30
+      structure Word = gs_31
+      structure Word32 = gs_32
+      structure Word64 = gs_33
+      structure Word8 = gs_34
+      html4.sml
+   in
+      structure gs_50 = HTML4
+   end
+   local
+      open l14
+   in
+      structure gs_51 = Option
+   end
+   local
+      open l14
+   in
+      structure gs_52 = StringCvt
+   end
+   local
+      structure AntlrStreamPos = gs_35
+      structure Atom = gs_2
+      structure Char = gs_5
+      structure CharArray = gs_6
+      structure CharVector = gs_7
+      structure FixedInt = gs_8
+      structure General = gs_9
+      structure HTML4TokenUtils = gs_48
+      structure Int = gs_10
+      structure Int32 = gs_11
+      structure Int64 = gs_12
+      structure IntInf = gs_13
+      structure LargeInt = gs_14
+      structure LargeReal = gs_15
+      structure LargeWord = gs_16
+      structure List = gs_37
+      structure OS = gs_17
+      structure Position = gs_18
+      structure Real = gs_19
+      structure Real64 = gs_20
+      structure RealArray = gs_21
+      structure RealArraySlice = gs_22
+      structure RealVector = gs_23
+      structure RealVectorSlice = gs_24
+      structure SMLofNJ = gs_25
+      structure Socket = gs_26
+      structure String = gs_27
+      structure StringCvt = gs_52
+      structure Substring = gs_28
+      structure SysWord = gs_29
+      structure TextIO = gs_4
+      structure Time = gs_30
+      structure ULexBuffer = gs_46
+      structure UTF8 = gs_45
+      structure Vector = gs_44
+      structure Word = gs_31
+      structure Word32 = gs_32
+      structure Word64 = gs_33
+      structure Word8 = gs_34
+      html4.l.sml
+   in
+      structure gs_53 = HTML4Lexer
+   end
+   local
+      structure AntlrStreamPos = gs_35
+      structure Atom = gs_2
+      structure Char = gs_5
+      structure CharArray = gs_6
+      structure CharVector = gs_7
+      structure FixedInt = gs_8
+      structure General = gs_9
+      structure HTML4 = gs_50
+      structure HTML4Lexer = gs_53
+      functor HTML4ParseFn = gs_40
+      structure HTML4TokenUtils = gs_48
+      structure HTML4Tokens = gs_41
+      structure HTML4Utils = gs_39
+      structure Int = gs_10
+      structure Int32 = gs_11
+      structure Int64 = gs_12
+      structure IntInf = gs_13
+      structure LargeInt = gs_14
+      structure LargeReal = gs_15
+      structure LargeWord = gs_16
+      structure OS = gs_17
+      structure Option = gs_51
+      structure Position = gs_18
+      structure Real = gs_19
+      structure Real64 = gs_20
+      structure RealArray = gs_21
+      structure RealArraySlice = gs_22
+      structure RealVector = gs_23
+      structure RealVectorSlice = gs_24
+      structure SMLofNJ = gs_25
+      structure Socket = gs_26
+      structure String = gs_27
+      structure Substring = gs_28
+      structure SysWord = gs_29
+      structure TextIO = gs_4
+      structure Time = gs_30
+      structure Word = gs_31
+      structure Word32 = gs_32
+      structure Word64 = gs_33
+      structure Word8 = gs_34
+      html4-parser.sml
+   in
+      structure gs_54 = HTML4Parser
+   end
+   local
+      open l4
+   in
+      structure gs_55 = Format
+   end
+   local
+      structure Atom = gs_2
+      structure Char = gs_5
+      structure CharArray = gs_6
+      structure CharVector = gs_7
+      structure FixedInt = gs_8
+      structure Format = gs_55
+      structure General = gs_9
+      structure HTML4 = gs_50
+      structure Int = gs_10
+      structure Int32 = gs_11
+      structure Int64 = gs_12
+      structure IntInf = gs_13
+      structure LargeInt = gs_14
+      structure LargeReal = gs_15
+      structure LargeWord = gs_16
+      structure List = gs_37
+      structure OS = gs_17
+      structure Position = gs_18
+      structure Real = gs_19
+      structure Real64 = gs_20
+      structure RealArray = gs_21
+      structure RealArraySlice = gs_22
+      structure RealVector = gs_23
+      structure RealVectorSlice = gs_24
+      structure SMLofNJ = gs_25
+      structure Socket = gs_26
+      structure String = gs_27
+      structure Substring = gs_28
+      structure SysWord = gs_29
+      structure Time = gs_30
+      structure Word = gs_31
+      structure Word32 = gs_32
+      structure Word64 = gs_33
+      structure Word8 = gs_34
+      html4-print.sml
+   in
+      structure gs_56 = HTML4Print
+   end
+   local
+      structure Atom = gs_2
+      structure HTML4 = gs_50
+      html4-entities.sml
+   in
+      structure gs_57 = HTML4Entities
+   end
+   local
+      structure Atom = gs_2
+      html4-attrs.sml
+   in
+      structure gs_58 = HTML4Attrs
+   end
+in
+   signature HTML4 = gs_49
+   structure HTML4 = gs_50
+   structure HTML4Attrs = gs_58
+   structure HTML4Entities = gs_57
+   structure HTML4Parser = gs_54
+   structure HTML4Print = gs_56
+   structure HTML4TokenUtils = gs_48
+   structure HTML4Tokens = gs_41
+   structure HTML4Utils = gs_39
+end
+end
+
+end
diff --git a/HTML4/pp-init.sml b/HTML4/pp-init.sml
new file mode 100644
index 0000000..ca97b62
--- /dev/null
+++ b/HTML4/pp-init.sml
@@ -0,0 +1,67 @@
+ (* pp-init.sml
+ *
+ * COPYRIGHT (c) 2003 The SML/NJ Fellowship
+ *
+ * An implementation of SML/NJ's PP interface.
+ *   - This is an (almost) literal copy of the original code in
+ *     smlnj-lib/PP/examples/old-pp.sml
+ *)
+
+
+signature PRETTYPRINT =
+sig
+  include PP_STREAM
+  val with_pp : device -> (stream -> unit) -> unit
+  val pp_to_string : int -> (stream -> 'a -> unit) -> 'a -> string
+end
+
+structure PrettyPrint : PRETTYPRINT =
+struct
+
+  type ppconsumer = {
+      consumer : string -> unit,
+      linewidth : int,
+      flush : unit -> unit
+    }
+
+  structure Dev =
+  struct
+    type device = ppconsumer
+    type style = unit
+    fun sameStyle _ = true
+    fun pushStyle _ = ()
+    fun popStyle _ = ()
+    fun defaultStyle _ = ()
+    fun depth _ = NONE
+    fun lineWidth {consumer, linewidth, flush} = SOME linewidth
+    fun textWidth _ = NONE
+    fun space ({consumer, linewidth, flush}, n) =
+          consumer (StringCvt.padLeft #" " n "")
+    fun newline {consumer, linewidth, flush} = consumer "\n"
+    fun string ({consumer, linewidth, flush}, s) = consumer s
+    fun char ({consumer, linewidth, flush}, c) = consumer(str c)
+    fun flush {consumer, linewidth, flush} = flush()
+  end
+
+  structure PP = PPStreamFn
+      (structure Token = StringToken
+       structure Device = Dev)
+
+  open PP
+
+  fun with_pp device (f: PP.stream -> unit) =
+      let val ppstrm = PP.openStream device
+       in f ppstrm;
+          PP.closeStream ppstrm
+      end
+
+  fun pp_to_string wid ppFn obj =
+      let val l = ref ([] : string list)
+          fun attach s = l := s :: !l
+          val device = {consumer = attach, linewidth = wid, flush = fn()=>()}
+       in with_pp device
+            (fn ppStrm => ppFn ppStrm obj);
+          String.concat(List.rev(!l))
+      end
+
+end (* structure PrettyPrint *)
diff --git a/HashCons/hash-cons-lib.mlb b/HashCons/hash-cons-lib.mlb
new file mode 100644
index 0000000..7a7540a
--- /dev/null
+++ b/HashCons/hash-cons-lib.mlb
@@ -0,0 +1,289 @@
+
+ann
+  "nonexhaustiveBind ignore" "nonexhaustiveMatch warn"
+  "redundantBind warn" "redundantMatch warn"
+  "sequenceNonUnit ignore"
+  "warnUnused false" "forceUsed"
+in
+
+local
+  basis l13 =
+    bas
+      (* $/basis.cm ====> *) $(SML_LIB)/basis/basis.mlb $(SML_LIB)/basis/sml-nj.mlb
+    end
+  basis l4 =
+    bas
+      (* $/smlnj-lib.cm ====> *) $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
+    end
+in
+local
+   $(SML_LIB)/basis/pervasive.mlb
+   local
+      open l4
+   in
+      structure gs_0 = HashString
+   end
+   local
+      open l4
+   in
+      signature gs_1 = HASH_KEY
+   end
+   local
+      open l13
+   in
+      structure gs_2 = Array
+   end
+   local
+      open l13
+   in
+      structure gs_3 = List
+   end
+   local
+      open l4
+   in
+      structure gs_4 = PrimeSizes
+   end
+   local
+      open l13
+   in
+      structure gs_5 = Char
+      structure gs_6 = CharArray
+      structure gs_7 = CharVector
+      structure gs_8 = FixedInt
+      structure gs_9 = General
+      structure gs_10 = Int
+      structure gs_11 = Int32
+      structure gs_12 = Int64
+      structure gs_13 = IntInf
+      structure gs_14 = LargeInt
+      structure gs_15 = LargeReal
+      structure gs_16 = LargeWord
+      structure gs_17 = OS
+      structure gs_18 = Position
+      structure gs_19 = Real
+      structure gs_20 = Real64
+      structure gs_21 = RealArray
+      structure gs_22 = RealArraySlice
+      structure gs_23 = RealVector
+      structure gs_24 = RealVectorSlice
+      structure gs_25 = SMLofNJ
+      structure gs_26 = Socket
+      structure gs_27 = String
+      structure gs_28 = Substring
+      structure gs_29 = SysWord
+      structure gs_30 = Time
+      structure gs_31 = Word
+      structure gs_32 = Word32
+      structure gs_33 = Word64
+      structure gs_34 = Word8
+   end
+   local
+      hash-cons-sig.sml
+   in
+      signature gs_35 = HASH_CONS
+   end
+   local
+      structure Array = gs_2
+      structure Char = gs_5
+      structure CharArray = gs_6
+      structure CharVector = gs_7
+      structure FixedInt = gs_8
+      structure General = gs_9
+      signature HASH_CONS = gs_35
+      structure Int = gs_10
+      structure Int32 = gs_11
+      structure Int64 = gs_12
+      structure IntInf = gs_13
+      structure LargeInt = gs_14
+      structure LargeReal = gs_15
+      structure LargeWord = gs_16
+      structure List = gs_3
+      structure OS = gs_17
+      structure Position = gs_18
+      structure PrimeSizes = gs_4
+      structure Real = gs_19
+      structure Real64 = gs_20
+      structure RealArray = gs_21
+      structure RealArraySlice = gs_22
+      structure RealVector = gs_23
+      structure RealVectorSlice = gs_24
+      structure SMLofNJ = gs_25
+      structure Socket = gs_26
+      structure String = gs_27
+      structure Substring = gs_28
+      structure SysWord = gs_29
+      structure Time = gs_30
+      structure Word = gs_31
+      structure Word32 = gs_32
+      structure Word64 = gs_33
+      structure Word8 = gs_34
+      hash-cons.sml
+   in
+      structure gs_36 = HashCons
+   end
+   local
+      signature HASH_KEY = gs_1
+      structure HashCons = gs_36
+      hash-cons-ground-fn.sml
+   in
+      functor gs_37 = HashConsGroundFn
+   end
+   local
+      functor HashConsGroundFn = gs_37
+      structure HashString = gs_0
+      hash-cons-string.sml
+   in
+      structure gs_38 = HashConsString
+   end
+   local
+      structure HashCons = gs_36
+      hash-cons-set-sig.sml
+   in
+      signature gs_39 = HASH_CONS_SET
+   end
+   local
+      open l4
+   in
+      structure gs_40 = Atom
+   end
+   local
+      structure Atom = gs_40
+      functor HashConsGroundFn = gs_37
+      hash-cons-atom.sml
+   in
+      structure gs_41 = HashConsAtom
+   end
+   local
+      structure Char = gs_5
+      structure CharArray = gs_6
+      structure CharVector = gs_7
+      structure FixedInt = gs_8
+      structure General = gs_9
+      structure HashCons = gs_36
+      structure Int = gs_10
+      structure Int32 = gs_11
+      structure Int64 = gs_12
+      structure IntInf = gs_13
+      structure LargeInt = gs_14
+      structure LargeReal = gs_15
+      structure LargeWord = gs_16
+      structure OS = gs_17
+      structure Position = gs_18
+      structure Real = gs_19
+      structure Real64 = gs_20
+      structure RealArray = gs_21
+      structure RealArraySlice = gs_22
+      structure RealVector = gs_23
+      structure RealVectorSlice = gs_24
+      structure SMLofNJ = gs_25
+      structure Socket = gs_26
+      structure String = gs_27
+      structure Substring = gs_28
+      structure SysWord = gs_29
+      structure Time = gs_30
+      structure Word = gs_31
+      structure Word32 = gs_32
+      structure Word64 = gs_33
+      structure Word8 = gs_34
+      hash-cons-int.sml
+   in
+      structure gs_42 = HashConsInt
+   end
+   local
+      structure HashCons = gs_36
+      hash-cons-word.sml
+   in
+      structure gs_43 = HashConsWord
+   end
+   local
+      structure HashCons = gs_36
+      hash-cons-map-sig.sml
+   in
+      signature gs_44 = HASH_CONS_MAP
+   end
+   local
+      open l4
+   in
+      structure gs_45 = WordRedBlackMap
+   end
+   local
+      open l13
+   in
+      structure gs_46 = Option
+   end
+   local
+      signature HASH_CONS_MAP = gs_44
+      structure HashCons = gs_36
+      structure Option = gs_46
+      structure WordRedBlackMap = gs_45
+      hash-cons-map.sml
+   in
+      structure gs_47 = HashConsMap
+   end
+   local
+      structure HashCons = gs_36
+      hash-cons-bool.sml
+   in
+      structure gs_48 = HashConsBool
+   end
+   local
+      open l4
+   in
+      structure gs_49 = LibBase
+   end
+   local
+      structure Char = gs_5
+      structure CharArray = gs_6
+      structure CharVector = gs_7
+      structure FixedInt = gs_8
+      structure General = gs_9
+      signature HASH_CONS_SET = gs_39
+      structure HashCons = gs_36
+      structure Int = gs_10
+      structure Int32 = gs_11
+      structure Int64 = gs_12
+      structure IntInf = gs_13
+      structure LargeInt = gs_14
+      structure LargeReal = gs_15
+      structure LargeWord = gs_16
+      structure LibBase = gs_49
+      structure List = gs_3
+      structure OS = gs_17
+      structure Position = gs_18
+      structure Real = gs_19
+      structure Real64 = gs_20
+      structure RealArray = gs_21
+      structure RealArraySlice = gs_22
+      structure RealVector = gs_23
+      structure RealVectorSlice = gs_24
+      structure SMLofNJ = gs_25
+      structure Socket = gs_26
+      structure String = gs_27
+      structure Substring = gs_28
+      structure SysWord = gs_29
+      structure Time = gs_30
+      structure Word = gs_31
+      structure Word32 = gs_32
+      structure Word64 = gs_33
+      structure Word8 = gs_34
+      hash-cons-set.sml
+   in
+      structure gs_50 = HashConsSet
+   end
+in
+   signature HASH_CONS = gs_35
+   signature HASH_CONS_MAP = gs_44
+   signature HASH_CONS_SET = gs_39
+   structure HashCons = gs_36
+   structure HashConsAtom = gs_41
+   structure HashConsBool = gs_48
+   functor HashConsGroundFn = gs_37
+   structure HashConsInt = gs_42
+   structure HashConsMap = gs_47
+   structure HashConsSet = gs_50
+   structure HashConsString = gs_38
+   structure HashConsWord = gs_43
+end
+end
+
+end
diff --git a/INet/inet-lib.mlb b/INet/inet-lib.mlb
new file mode 100644
index 0000000..cffb30e
--- /dev/null
+++ b/INet/inet-lib.mlb
@@ -0,0 +1,243 @@
+
+ann
+  "nonexhaustiveBind warn" "nonexhaustiveMatch warn"
+  "redundantBind warn" "redundantMatch warn"
+  "sequenceNonUnit ignore"
+  "warnUnused false" "forceUsed"
+in
+
+local
+  basis l33 =
+    bas
+      (* $/basis.cm ====> *) $(SML_LIB)/basis/basis.mlb $(SML_LIB)/basis/sml-nj.mlb
+    end
+  basis l60 =
+    bas
+      (* $/smlnj-lib.cm ====> *) $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
+    end
+in
+local
+   $(SML_LIB)/basis/pervasive.mlb
+   local
+      open l33
+   in
+      structure gs_0 = Char
+      structure gs_1 = CharArray
+      structure gs_2 = CharVector
+      structure gs_3 = FixedInt
+      structure gs_4 = General
+      structure gs_5 = Int
+      structure gs_6 = Int32
+      structure gs_7 = Int64
+      structure gs_8 = IntInf
+      structure gs_9 = LargeInt
+      structure gs_10 = LargeReal
+      structure gs_11 = LargeWord
+      structure gs_12 = OS
+      structure gs_13 = Position
+      structure gs_14 = Real
+      structure gs_15 = Real64
+      structure gs_16 = RealArray
+      structure gs_17 = RealArraySlice
+      structure gs_18 = RealVector
+      structure gs_19 = RealVectorSlice
+      structure gs_20 = SMLofNJ
+      structure gs_21 = Socket
+      structure gs_22 = String
+      structure gs_23 = Substring
+      structure gs_24 = SysWord
+      structure gs_25 = Time
+      structure gs_26 = Word
+      structure gs_27 = Word32
+      structure gs_28 = Word64
+      structure gs_29 = Word8
+   end
+   local
+      open l33
+   in
+      structure gs_30 = Word8Array
+   end
+   local
+      open l33
+   in
+      structure gs_31 = Word8Vector
+   end
+   local
+      open l33
+   in
+      structure gs_32 = INetSock
+   end
+   local
+      open l33
+   in
+      structure gs_33 = NetHostDB
+   end
+   local
+      open l33
+   in
+      structure gs_34 = StringCvt
+   end
+   local
+      structure Char = gs_0
+      structure CharArray = gs_1
+      structure CharVector = gs_2
+      structure FixedInt = gs_3
+      structure General = gs_4
+      structure INetSock = gs_32
+      structure Int = gs_5
+      structure Int32 = gs_6
+      structure Int64 = gs_7
+      structure IntInf = gs_8
+      structure LargeInt = gs_9
+      structure LargeReal = gs_10
+      structure LargeWord = gs_11
+      structure NetHostDB = gs_33
+      structure OS = gs_12
+      structure Position = gs_13
+      structure Real = gs_14
+      structure Real64 = gs_15
+      structure RealArray = gs_16
+      structure RealArraySlice = gs_17
+      structure RealVector = gs_18
+      structure RealVectorSlice = gs_19
+      structure SMLofNJ = gs_20
+      structure Socket = gs_21
+      structure String = gs_22
+      structure StringCvt = gs_34
+      structure Substring = gs_23
+      structure SysWord = gs_24
+      structure Time = gs_25
+      structure Word = gs_26
+      structure Word32 = gs_27
+      structure Word64 = gs_28
+      structure Word8 = gs_29
+      structure Word8Array = gs_30
+      structure Word8Vector = gs_31
+      sock-util-sig.sml
+   in
+      signature gs_35 = SOCK_UTIL
+   end
+   local
+      open l33
+   in
+      structure gs_36 = UnixSock
+   end
+   local
+      open l60
+   in
+      structure gs_37 = ParserComb
+   end
+   local
+      open l33
+   in
+      structure gs_38 = NetServDB
+   end
+   local
+      open l33
+   in
+      structure gs_39 = Word8ArraySlice
+   end
+   local
+      open l33
+   in
+      structure gs_40 = Word8VectorSlice
+   end
+   local
+      open l33
+   in
+      structure gs_41 = Byte
+   end
+   local
+      structure Byte = gs_41
+      structure Char = gs_0
+      structure CharArray = gs_1
+      structure CharVector = gs_2
+      structure FixedInt = gs_3
+      structure General = gs_4
+      structure INetSock = gs_32
+      structure Int = gs_5
+      structure Int32 = gs_6
+      structure Int64 = gs_7
+      structure IntInf = gs_8
+      structure LargeInt = gs_9
+      structure LargeReal = gs_10
+      structure LargeWord = gs_11
+      structure NetHostDB = gs_33
+      structure NetServDB = gs_38
+      structure OS = gs_12
+      structure ParserComb = gs_37
+      structure Position = gs_13
+      structure Real = gs_14
+      structure Real64 = gs_15
+      structure RealArray = gs_16
+      structure RealArraySlice = gs_17
+      structure RealVector = gs_18
+      structure RealVectorSlice = gs_19
+      structure SMLofNJ = gs_20
+      signature SOCK_UTIL = gs_35
+      structure Socket = gs_21
+      structure String = gs_22
+      structure StringCvt = gs_34
+      structure Substring = gs_23
+      structure SysWord = gs_24
+      structure Time = gs_25
+      structure Word = gs_26
+      structure Word32 = gs_27
+      structure Word64 = gs_28
+      structure Word8 = gs_29
+      structure Word8Array = gs_30
+      structure Word8ArraySlice = gs_39
+      structure Word8Vector = gs_31
+      structure Word8VectorSlice = gs_40
+      sock-util.sml
+   in
+      structure gs_42 = SockUtil
+   end
+   local
+      structure Char = gs_0
+      structure CharArray = gs_1
+      structure CharVector = gs_2
+      structure FixedInt = gs_3
+      structure General = gs_4
+      structure Int = gs_5
+      structure Int32 = gs_6
+      structure Int64 = gs_7
+      structure IntInf = gs_8
+      structure LargeInt = gs_9
+      structure LargeReal = gs_10
+      structure LargeWord = gs_11
+      structure OS = gs_12
+      structure Position = gs_13
+      structure Real = gs_14
+      structure Real64 = gs_15
+      structure RealArray = gs_16
+      structure RealArraySlice = gs_17
+      structure RealVector = gs_18
+      structure RealVectorSlice = gs_19
+      structure SMLofNJ = gs_20
+      signature SOCK_UTIL = gs_35
+      structure SockUtil = gs_42
+      structure Socket = gs_21
+      structure String = gs_22
+      structure Substring = gs_23
+      structure SysWord = gs_24
+      structure Time = gs_25
+      structure UnixSock = gs_36
+      structure Word = gs_26
+      structure Word32 = gs_27
+      structure Word64 = gs_28
+      structure Word8 = gs_29
+      unix-sock-util.sml
+   in
+      signature gs_43 = UNIX_SOCK_UTIL
+      structure gs_44 = UnixSockUtil
+   end
+in
+   signature SOCK_UTIL = gs_35
+   structure SockUtil = gs_42
+   signature UNIX_SOCK_UTIL = gs_43
+   structure UnixSockUtil = gs_44
+end
+end
+
+end
diff --git a/JSON/json-lib.mlb b/JSON/json-lib.mlb
index afbd211..f7e7aac 100644
--- a/JSON/json-lib.mlb
+++ b/JSON/json-lib.mlb
@@ -1,57 +1,491 @@
-(* json-lib.mlb
- *
- * COPYRIGHT (c) 2021 The Fellowship of SML/NJ (http://www.smlnj.org)
- * All rights reserved.
- *
- * An MLB file for the JSON library, so that it can be used by MLton programs.
- *)
-
-local
-
-  $(SML_LIB)/basis/basis.mlb
-  $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
-  $(SML_LIB)/mllpt-lib/ml-lpt-lib.mlb
-
-  ann
-    "nonexhaustiveMatch warn" "redundantMatch warn"
-    "sequenceNonUnit ignore"
-    "warnUnused false" "forceUsed"
-  in
-
-    json-tokens.sml
-    json.lex.sml
-    json.sml
-    json-source.sml
-    json-stream-parser.sml
-    json-parser.sml
-    json-stream-output.sig
-    json-stream-output.fun
-(* NOTE: MLton does not support the CharBuffer Basis Library extension
-    json-buffer-printer.sml
-*)
-    json-stream-printer.sml
-    json-printer.sml
-    errors.sml
-    json-util.sml
-    json-decode.sml
-
-  end
 
+ann
+  "nonexhaustiveBind ignore" "nonexhaustiveMatch warn"
+  "redundantBind warn" "redundantMatch warn"
+  "sequenceNonUnit ignore"
+  "warnUnused false" "forceUsed"
 in
 
-(* DOM-style API (tree based) *)
-  structure JSON
-  structure JSONParser
-  structure JSONPrinter
-  structure JSONDecode
-  structure JSONUtil
-
-(* SAX-style API (event based) *)
-  signature JSON_STREAM_OUTPUT
-  structure JSONStreamParser
-(* NOTE: MLton does not support the CharBuffer Basis Library extension
-  structure JSONBufferPrinter
-*)
-  structure JSONStreamPrinter
+local
+  basis l4 =
+    bas
+      (* $/basis.cm ====> *) $(SML_LIB)/basis/basis.mlb $(SML_LIB)/basis/sml-nj.mlb $(SML_LIB)/basis/unsafe.mlb $(SML_LIB)/smlnj-lib/Compat/fn/sources.mlb $(SML_LIB)/smlnj-lib/Compat/mono-buffer/sources.mlb
+    end
+  basis l48 =
+    bas
+      (* $/smlnj-lib.cm ====> *) $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
+    end
+in
+local
+   $(SML_LIB)/basis/pervasive.mlb
+   local
+      open l4
+   in
+      structure gs_0 = CharBuffer
+   end
+   local
+      open l4
+   in
+      structure gs_1 = Char
+      structure gs_2 = CharArray
+      structure gs_3 = CharVector
+      structure gs_4 = FixedInt
+      structure gs_5 = General
+      structure gs_6 = Int
+      structure gs_7 = Int32
+      structure gs_8 = Int64
+      structure gs_9 = IntInf
+      structure gs_10 = LargeInt
+      structure gs_11 = LargeReal
+      structure gs_12 = LargeWord
+      structure gs_13 = OS
+      structure gs_14 = Position
+      structure gs_15 = Real
+      structure gs_16 = Real64
+      structure gs_17 = RealArray
+      structure gs_18 = RealArraySlice
+      structure gs_19 = RealVector
+      structure gs_20 = RealVectorSlice
+      structure gs_21 = SMLofNJ
+      structure gs_22 = Socket
+      structure gs_23 = String
+      structure gs_24 = Substring
+      structure gs_25 = SysWord
+      structure gs_26 = Time
+      structure gs_27 = Word
+      structure gs_28 = Word32
+      structure gs_29 = Word64
+      structure gs_30 = Word8
+   end
+   local
+      structure Char = gs_1
+      structure CharArray = gs_2
+      structure CharVector = gs_3
+      structure FixedInt = gs_4
+      structure General = gs_5
+      structure Int = gs_6
+      structure Int32 = gs_7
+      structure Int64 = gs_8
+      structure IntInf = gs_9
+      structure LargeInt = gs_10
+      structure LargeReal = gs_11
+      structure LargeWord = gs_12
+      structure OS = gs_13
+      structure Position = gs_14
+      structure Real = gs_15
+      structure Real64 = gs_16
+      structure RealArray = gs_17
+      structure RealArraySlice = gs_18
+      structure RealVector = gs_19
+      structure RealVectorSlice = gs_20
+      structure SMLofNJ = gs_21
+      structure Socket = gs_22
+      structure String = gs_23
+      structure Substring = gs_24
+      structure SysWord = gs_25
+      structure Time = gs_26
+      structure Word = gs_27
+      structure Word32 = gs_28
+      structure Word64 = gs_29
+      structure Word8 = gs_30
+      json.sml
+   in
+      structure gs_31 = JSON
+   end
+   local
+      structure Char = gs_1
+      structure CharArray = gs_2
+      structure CharVector = gs_3
+      structure FixedInt = gs_4
+      structure General = gs_5
+      structure Int = gs_6
+      structure Int32 = gs_7
+      structure Int64 = gs_8
+      structure IntInf = gs_9
+      structure JSON = gs_31
+      structure LargeInt = gs_10
+      structure LargeReal = gs_11
+      structure LargeWord = gs_12
+      structure OS = gs_13
+      structure Position = gs_14
+      structure Real = gs_15
+      structure Real64 = gs_16
+      structure RealArray = gs_17
+      structure RealArraySlice = gs_18
+      structure RealVector = gs_19
+      structure RealVectorSlice = gs_20
+      structure SMLofNJ = gs_21
+      structure Socket = gs_22
+      structure String = gs_23
+      structure Substring = gs_24
+      structure SysWord = gs_25
+      structure Time = gs_26
+      structure Word = gs_27
+      structure Word32 = gs_28
+      structure Word64 = gs_29
+      structure Word8 = gs_30
+      json-stream-output.sig
+   in
+      signature gs_32 = JSON_STREAM_OUTPUT
+   end
+   local
+      open l48
+   in
+      structure gs_33 = Format
+   end
+   local
+      open l4
+   in
+      structure gs_34 = List
+   end
+   local
+      open l48
+   in
+      structure gs_35 = UTF8
+   end
+   local
+      open l4
+   in
+      structure gs_36 = StringCvt
+   end
+   local
+      structure Char = gs_1
+      structure CharArray = gs_2
+      structure CharVector = gs_3
+      structure FixedInt = gs_4
+      structure Format = gs_33
+      structure General = gs_5
+      structure Int = gs_6
+      structure Int32 = gs_7
+      structure Int64 = gs_8
+      structure IntInf = gs_9
+      structure JSON = gs_31
+      signature JSON_STREAM_OUTPUT = gs_32
+      structure LargeInt = gs_10
+      structure LargeReal = gs_11
+      structure LargeWord = gs_12
+      structure List = gs_34
+      structure OS = gs_13
+      structure Position = gs_14
+      structure Real = gs_15
+      structure Real64 = gs_16
+      structure RealArray = gs_17
+      structure RealArraySlice = gs_18
+      structure RealVector = gs_19
+      structure RealVectorSlice = gs_20
+      structure SMLofNJ = gs_21
+      structure Socket = gs_22
+      structure String = gs_23
+      structure StringCvt = gs_36
+      structure Substring = gs_24
+      structure SysWord = gs_25
+      structure Time = gs_26
+      structure UTF8 = gs_35
+      structure Word = gs_27
+      structure Word32 = gs_28
+      structure Word64 = gs_29
+      structure Word8 = gs_30
+      json-stream-output.fun
+   in
+      functor gs_37 = JSONStreamOutputFn
+      signature gs_38 = TEXT_OUTPUT_STREAM
+   end
+   local
+      structure CharBuffer = gs_0
+      functor JSONStreamOutputFn = gs_37
+      signature JSON_STREAM_OUTPUT = gs_32
+      signature TEXT_OUTPUT_STREAM = gs_38
+      json-buffer-printer.sml
+   in
+      structure gs_39 = JSONBufferPrinter
+   end
+   local
+      open l4
+   in
+      structure gs_40 = TextIO
+   end
+   local
+      open l4
+   in
+      structure gs_41 = IEEEReal
+   end
+   local
+      open l4
+   in
+      structure gs_42 = Unsafe
+   end
+   local
+      structure Char = gs_1
+      structure CharArray = gs_2
+      structure CharVector = gs_3
+      structure FixedInt = gs_4
+      structure General = gs_5
+      structure Int = gs_6
+      structure Int32 = gs_7
+      structure Int64 = gs_8
+      structure IntInf = gs_9
+      structure LargeInt = gs_10
+      structure LargeReal = gs_11
+      structure LargeWord = gs_12
+      structure OS = gs_13
+      structure Position = gs_14
+      structure Real = gs_15
+      structure Real64 = gs_16
+      structure RealArray = gs_17
+      structure RealArraySlice = gs_18
+      structure RealVector = gs_19
+      structure RealVectorSlice = gs_20
+      structure SMLofNJ = gs_21
+      structure Socket = gs_22
+      structure String = gs_23
+      structure Substring = gs_24
+      structure SysWord = gs_25
+      structure TextIO = gs_40
+      structure Time = gs_26
+      structure Word = gs_27
+      structure Word32 = gs_28
+      structure Word64 = gs_29
+      structure Word8 = gs_30
+      json-source.sml
+   in
+      structure gs_43 = JSONSource
+   end
+   local
+      structure Char = gs_1
+      structure CharArray = gs_2
+      structure CharVector = gs_3
+      structure FixedInt = gs_4
+      structure General = gs_5
+      structure IEEEReal = gs_41
+      structure Int = gs_6
+      structure Int32 = gs_7
+      structure Int64 = gs_8
+      structure IntInf = gs_9
+      structure JSONSource = gs_43
+      structure LargeInt = gs_10
+      structure LargeReal = gs_11
+      structure LargeWord = gs_12
+      structure List = gs_34
+      structure OS = gs_13
+      structure Position = gs_14
+      structure Real = gs_15
+      structure Real64 = gs_16
+      structure RealArray = gs_17
+      structure RealArraySlice = gs_18
+      structure RealVector = gs_19
+      structure RealVectorSlice = gs_20
+      structure SMLofNJ = gs_21
+      structure Socket = gs_22
+      structure String = gs_23
+      structure Substring = gs_24
+      structure SysWord = gs_25
+      structure TextIO = gs_40
+      structure Time = gs_26
+      structure Unsafe = gs_42
+      structure Word = gs_27
+      structure Word32 = gs_28
+      structure Word64 = gs_29
+      structure Word8 = gs_30
+      json-stream-parser.sml
+   in
+      structure gs_44 = JSONStreamParser
+   end
+   local
+      functor JSONStreamOutputFn = gs_37
+      signature JSON_STREAM_OUTPUT = gs_32
+      signature TEXT_OUTPUT_STREAM = gs_38
+      structure TextIO = gs_40
+      json-stream-printer.sml
+   in
+      structure gs_45 = JSONStreamPrinter
+   end
+   local
+      open l4
+   in
+      structure gs_46 = Vector
+   end
+   local
+      open l4
+   in
+      structure gs_47 = Fn
+   end
+   local
+      structure Char = gs_1
+      structure CharArray = gs_2
+      structure CharVector = gs_3
+      structure FixedInt = gs_4
+      structure General = gs_5
+      structure IEEEReal = gs_41
+      structure Int = gs_6
+      structure Int32 = gs_7
+      structure Int64 = gs_8
+      structure IntInf = gs_9
+      structure JSON = gs_31
+      structure JSONSource = gs_43
+      structure LargeInt = gs_10
+      structure LargeReal = gs_11
+      structure LargeWord = gs_12
+      structure List = gs_34
+      structure OS = gs_13
+      structure Position = gs_14
+      structure Real = gs_15
+      structure Real64 = gs_16
+      structure RealArray = gs_17
+      structure RealArraySlice = gs_18
+      structure RealVector = gs_19
+      structure RealVectorSlice = gs_20
+      structure SMLofNJ = gs_21
+      structure Socket = gs_22
+      structure String = gs_23
+      structure Substring = gs_24
+      structure SysWord = gs_25
+      structure TextIO = gs_40
+      structure Time = gs_26
+      structure Unsafe = gs_42
+      structure Word = gs_27
+      structure Word32 = gs_28
+      structure Word64 = gs_29
+      structure Word8 = gs_30
+      json-parser.sml
+   in
+      structure gs_48 = JSONParser
+   end
+   local
+      structure Char = gs_1
+      structure CharArray = gs_2
+      structure CharVector = gs_3
+      structure FixedInt = gs_4
+      structure General = gs_5
+      structure Int = gs_6
+      structure Int32 = gs_7
+      structure Int64 = gs_8
+      structure IntInf = gs_9
+      structure JSON = gs_31
+      structure LargeInt = gs_10
+      structure LargeReal = gs_11
+      structure LargeWord = gs_12
+      structure OS = gs_13
+      structure Position = gs_14
+      structure Real = gs_15
+      structure Real64 = gs_16
+      structure RealArray = gs_17
+      structure RealArraySlice = gs_18
+      structure RealVector = gs_19
+      structure RealVectorSlice = gs_20
+      structure SMLofNJ = gs_21
+      structure Socket = gs_22
+      structure String = gs_23
+      structure Substring = gs_24
+      structure SysWord = gs_25
+      structure Time = gs_26
+      structure Word = gs_27
+      structure Word32 = gs_28
+      structure Word64 = gs_29
+      structure Word8 = gs_30
+      errors.sml
+   in
+      structure gs_49 = Errors
+   end
+   local
+      structure Char = gs_1
+      structure CharArray = gs_2
+      structure CharVector = gs_3
+      structure Errors = gs_49
+      structure FixedInt = gs_4
+      structure General = gs_5
+      structure Int = gs_6
+      structure Int32 = gs_7
+      structure Int64 = gs_8
+      structure IntInf = gs_9
+      structure JSON = gs_31
+      structure LargeInt = gs_10
+      structure LargeReal = gs_11
+      structure LargeWord = gs_12
+      structure List = gs_34
+      structure OS = gs_13
+      structure Position = gs_14
+      structure Real = gs_15
+      structure Real64 = gs_16
+      structure RealArray = gs_17
+      structure RealArraySlice = gs_18
+      structure RealVector = gs_19
+      structure RealVectorSlice = gs_20
+      structure SMLofNJ = gs_21
+      structure Socket = gs_22
+      structure String = gs_23
+      structure Substring = gs_24
+      structure SysWord = gs_25
+      structure Time = gs_26
+      structure Vector = gs_46
+      structure Word = gs_27
+      structure Word32 = gs_28
+      structure Word64 = gs_29
+      structure Word8 = gs_30
+      json-util.sml
+   in
+      structure gs_50 = JSONUtil
+   end
+   local
+      structure Char = gs_1
+      structure CharArray = gs_2
+      structure CharVector = gs_3
+      structure Errors = gs_49
+      structure FixedInt = gs_4
+      structure Fn = gs_47
+      structure General = gs_5
+      structure Int = gs_6
+      structure Int32 = gs_7
+      structure Int64 = gs_8
+      structure IntInf = gs_9
+      structure JSON = gs_31
+      structure JSONParser = gs_48
+      structure JSONUtil = gs_50
+      structure LargeInt = gs_10
+      structure LargeReal = gs_11
+      structure LargeWord = gs_12
+      structure List = gs_34
+      structure OS = gs_13
+      structure Position = gs_14
+      structure Real = gs_15
+      structure Real64 = gs_16
+      structure RealArray = gs_17
+      structure RealArraySlice = gs_18
+      structure RealVector = gs_19
+      structure RealVectorSlice = gs_20
+      structure SMLofNJ = gs_21
+      structure Socket = gs_22
+      structure String = gs_23
+      structure Substring = gs_24
+      structure SysWord = gs_25
+      structure Time = gs_26
+      structure Vector = gs_46
+      structure Word = gs_27
+      structure Word32 = gs_28
+      structure Word64 = gs_29
+      structure Word8 = gs_30
+      json-decode.sml
+   in
+      structure gs_51 = JSONDecode
+   end
+   local
+      structure JSON = gs_31
+      structure JSONStreamPrinter = gs_45
+      structure TextIO = gs_40
+      json-printer.sml
+   in
+      structure gs_52 = JSONPrinter
+   end
+in
+   structure JSON = gs_31
+   structure JSONBufferPrinter = gs_39
+   structure JSONDecode = gs_51
+   structure JSONParser = gs_48
+   structure JSONPrinter = gs_52
+   structure JSONStreamParser = gs_44
+   structure JSONStreamPrinter = gs_45
+   structure JSONUtil = gs_50
+   signature JSON_STREAM_OUTPUT = gs_32
+end
+end
 
 end
diff --git a/JSON/json-parser.sml b/JSON/json-parser.sml
index 8494d5c..7bb7cf3 100644
--- a/JSON/json-parser.sml
+++ b/JSON/json-parser.sml
@@ -56,10 +56,10 @@ structure JSONParser :> sig
      *)
     fun mkString (_, []) = ""
       | mkString (n, cs) = let
-          val s = Unsafe.CharVector.create n
-          fun init (_, []) = s
+          val s = Unsafe.CharArray.create n
+          fun init (_, []) = CharArray.vector s
             | init (i, c::cs) = (
-                Unsafe.CharVector.update(s, i, c);
+                Unsafe.CharArray.update(s, i, c);
                 init (dec i, cs))
           in
             init (dec n, cs)
diff --git a/JSON/json-stream-parser.sml b/JSON/json-stream-parser.sml
index 1b11ea4..cb709d9 100644
--- a/JSON/json-stream-parser.sml
+++ b/JSON/json-stream-parser.sml
@@ -90,10 +90,10 @@ structure JSONStreamParser :> sig
      *)
     fun mkString (_, []) = ""
       | mkString (n, cs) = let
-          val s = Unsafe.CharVector.create n
-          fun init (_, []) = s
+          val s = Unsafe.CharArray.create n
+          fun init (_, []) = CharArray.vector s
             | init (i, c::cs) = (
-                Unsafe.CharVector.update(s, i, c);
+                Unsafe.CharArray.update(s, i, c);
                 init (dec i, cs))
           in
             init (dec n, cs)
diff --git a/PP/pp-lib.mlb b/PP/pp-lib.mlb
new file mode 100644
index 0000000..83017b9
--- /dev/null
+++ b/PP/pp-lib.mlb
@@ -0,0 +1,409 @@
+
+ann
+  "nonexhaustiveBind warn" "nonexhaustiveMatch ignore"
+  "redundantBind warn" "redundantMatch warn"
+  "sequenceNonUnit ignore"
+  "warnUnused false" "forceUsed"
+  "allowOrPats true" "allowVectorExpsAndPats true"
+in
+
+local
+  basis l37 =
+    bas
+      (* $/basis.cm ====> *) $(SML_LIB)/basis/basis.mlb $(SML_LIB)/basis/sml-nj.mlb $(SML_LIB)/smlnj-lib/Compat/mono-buffer/sources.mlb
+    end
+  basis l55 =
+    bas
+      (* $/smlnj-lib.cm ====> *) $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
+    end
+in
+local
+   $(SML_LIB)/basis/pervasive.mlb
+   local
+      src/pp-token-sig.sml
+   in
+      signature gs_0 = PP_TOKEN
+   end
+   local
+      open l37
+   in
+      structure gs_1 = Char
+      structure gs_2 = CharArray
+      structure gs_3 = CharVector
+      structure gs_4 = FixedInt
+      structure gs_5 = General
+      structure gs_6 = Int
+      structure gs_7 = Int32
+      structure gs_8 = Int64
+      structure gs_9 = IntInf
+      structure gs_10 = LargeInt
+      structure gs_11 = LargeReal
+      structure gs_12 = LargeWord
+      structure gs_13 = OS
+      structure gs_14 = Position
+      structure gs_15 = Real
+      structure gs_16 = Real64
+      structure gs_17 = RealArray
+      structure gs_18 = RealArraySlice
+      structure gs_19 = RealVector
+      structure gs_20 = RealVectorSlice
+      structure gs_21 = SMLofNJ
+      structure gs_22 = Socket
+      structure gs_23 = String
+      structure gs_24 = Substring
+      structure gs_25 = SysWord
+      structure gs_26 = Time
+      structure gs_27 = Word
+      structure gs_28 = Word32
+      structure gs_29 = Word64
+      structure gs_30 = Word8
+   end
+   local
+      structure Char = gs_1
+      structure CharArray = gs_2
+      structure CharVector = gs_3
+      structure FixedInt = gs_4
+      structure General = gs_5
+      structure Int = gs_6
+      structure Int32 = gs_7
+      structure Int64 = gs_8
+      structure IntInf = gs_9
+      structure LargeInt = gs_10
+      structure LargeReal = gs_11
+      structure LargeWord = gs_12
+      structure OS = gs_13
+      signature PP_TOKEN = gs_0
+      structure Position = gs_14
+      structure Real = gs_15
+      structure Real64 = gs_16
+      structure RealArray = gs_17
+      structure RealArraySlice = gs_18
+      structure RealVector = gs_19
+      structure RealVectorSlice = gs_20
+      structure SMLofNJ = gs_21
+      structure Socket = gs_22
+      structure String = gs_23
+      structure Substring = gs_24
+      structure SysWord = gs_25
+      structure Time = gs_26
+      structure Word = gs_27
+      structure Word32 = gs_28
+      structure Word64 = gs_29
+      structure Word8 = gs_30
+      devices/string-token.sml
+   in
+      structure gs_31 = StringToken
+   end
+   local
+      src/pp-stream-sig.sml
+   in
+      signature gs_32 = PP_STREAM
+   end
+   local
+      open l37
+   in
+      structure gs_33 = TextIO
+   end
+   local
+      open l37
+   in
+      structure gs_34 = CharBuffer
+   end
+   local
+      open l55
+   in
+      structure gs_35 = Format
+   end
+   local
+      open l55
+   in
+      structure gs_36 = Queue
+   end
+   local
+      open l37
+   in
+      structure gs_37 = Option
+   end
+   local
+      open l55
+   in
+      structure gs_38 = ListFormat
+   end
+   local
+      src/pp-device-sig.sml
+   in
+      signature gs_39 = PP_DEVICE
+   end
+   local
+      structure Char = gs_1
+      structure CharArray = gs_2
+      structure CharVector = gs_3
+      structure FixedInt = gs_4
+      structure Format = gs_35
+      structure General = gs_5
+      structure Int = gs_6
+      structure Int32 = gs_7
+      structure Int64 = gs_8
+      structure IntInf = gs_9
+      structure LargeInt = gs_10
+      structure LargeReal = gs_11
+      structure LargeWord = gs_12
+      structure ListFormat = gs_38
+      structure OS = gs_13
+      structure Option = gs_37
+      signature PP_DEVICE = gs_39
+      signature PP_STREAM = gs_32
+      signature PP_TOKEN = gs_0
+      structure Position = gs_14
+      structure Queue = gs_36
+      structure Real = gs_15
+      structure Real64 = gs_16
+      structure RealArray = gs_17
+      structure RealArraySlice = gs_18
+      structure RealVector = gs_19
+      structure RealVectorSlice = gs_20
+      structure SMLofNJ = gs_21
+      structure Socket = gs_22
+      structure String = gs_23
+      structure Substring = gs_24
+      structure SysWord = gs_25
+      structure TextIO = gs_33
+      structure Time = gs_26
+      structure Word = gs_27
+      structure Word32 = gs_28
+      structure Word64 = gs_29
+      structure Word8 = gs_30
+      src/pp-stream-fn.sml
+   in
+      functor gs_40 = PPStreamFn
+   end
+   local
+      open l37
+   in
+      structure gs_41 = StringCvt
+   end
+   local
+      structure Char = gs_1
+      structure CharArray = gs_2
+      structure CharVector = gs_3
+      structure FixedInt = gs_4
+      structure General = gs_5
+      structure Int = gs_6
+      structure Int32 = gs_7
+      structure Int64 = gs_8
+      structure IntInf = gs_9
+      structure LargeInt = gs_10
+      structure LargeReal = gs_11
+      structure LargeWord = gs_12
+      structure OS = gs_13
+      signature PP_DEVICE = gs_39
+      structure Position = gs_14
+      structure Real = gs_15
+      structure Real64 = gs_16
+      structure RealArray = gs_17
+      structure RealArraySlice = gs_18
+      structure RealVector = gs_19
+      structure RealVectorSlice = gs_20
+      structure SMLofNJ = gs_21
+      structure Socket = gs_22
+      structure String = gs_23
+      structure Substring = gs_24
+      structure SysWord = gs_25
+      structure Time = gs_26
+      structure Word = gs_27
+      structure Word32 = gs_28
+      structure Word64 = gs_29
+      structure Word8 = gs_30
+      devices/default-device-fn.sml
+   in
+      signature gs_42 = DEVICE_OPS
+      functor gs_43 = DefaultDeviceFn
+   end
+   local
+      structure CharBuffer = gs_34
+      signature DEVICE_OPS = gs_42
+      functor DefaultDeviceFn = gs_43
+      functor PPStreamFn = gs_40
+      signature PP_STREAM = gs_32
+      structure StringCvt = gs_41
+      structure StringToken = gs_31
+      structure TextIO = gs_33
+      devices/text-pp.sml
+   in
+      structure gs_44 = TextPP
+   end
+   local
+      open l37
+   in
+      structure gs_45 = List
+   end
+   local
+      open l37
+   in
+      structure gs_46 = TextPrimIO
+   end
+   local
+      open l55
+   in
+      structure gs_47 = ANSITerm
+   end
+   local
+      structure ANSITerm = gs_47
+      structure Char = gs_1
+      structure CharArray = gs_2
+      structure CharVector = gs_3
+      structure FixedInt = gs_4
+      structure General = gs_5
+      structure Int = gs_6
+      structure Int32 = gs_7
+      structure Int64 = gs_8
+      structure IntInf = gs_9
+      structure LargeInt = gs_10
+      structure LargeReal = gs_11
+      structure LargeWord = gs_12
+      structure List = gs_45
+      structure OS = gs_13
+      signature PP_DEVICE = gs_39
+      structure Position = gs_14
+      structure Real = gs_15
+      structure Real64 = gs_16
+      structure RealArray = gs_17
+      structure RealArraySlice = gs_18
+      structure RealVector = gs_19
+      structure RealVectorSlice = gs_20
+      structure SMLofNJ = gs_21
+      structure Socket = gs_22
+      structure String = gs_23
+      structure StringCvt = gs_41
+      structure Substring = gs_24
+      structure SysWord = gs_25
+      structure TextIO = gs_33
+      structure TextPrimIO = gs_46
+      structure Time = gs_26
+      structure Word = gs_27
+      structure Word32 = gs_28
+      structure Word64 = gs_29
+      structure Word8 = gs_30
+      devices/ansi-term-dev.sml
+   in
+      structure gs_48 = ANSITermDev
+   end
+   local
+      structure ANSITermDev = gs_48
+      structure Char = gs_1
+      structure CharArray = gs_2
+      structure CharVector = gs_3
+      structure FixedInt = gs_4
+      structure General = gs_5
+      structure Int = gs_6
+      structure Int32 = gs_7
+      structure Int64 = gs_8
+      structure IntInf = gs_9
+      structure LargeInt = gs_10
+      structure LargeReal = gs_11
+      structure LargeWord = gs_12
+      structure OS = gs_13
+      functor PPStreamFn = gs_40
+      signature PP_STREAM = gs_32
+      signature PP_TOKEN = gs_0
+      structure Position = gs_14
+      structure Real = gs_15
+      structure Real64 = gs_16
+      structure RealArray = gs_17
+      structure RealArraySlice = gs_18
+      structure RealVector = gs_19
+      structure RealVectorSlice = gs_20
+      structure SMLofNJ = gs_21
+      structure Socket = gs_22
+      structure String = gs_23
+      structure Substring = gs_24
+      structure SysWord = gs_25
+      structure TextIO = gs_33
+      structure Time = gs_26
+      structure Word = gs_27
+      structure Word32 = gs_28
+      structure Word64 = gs_29
+      structure Word8 = gs_30
+      devices/ansi-term-pp.sml
+   in
+      structure gs_49 = ANSITermPP
+   end
+   local
+      signature PP_STREAM = gs_32
+      src/pp-desc-sig.sml
+   in
+      signature gs_50 = PP_DESC
+   end
+   local
+      signature PP_STREAM = gs_32
+      structure TextIO = gs_33
+      src/pp-debug-fn.sml
+   in
+      functor gs_51 = PPDebugFn
+   end
+   local
+      signature PP_DESC = gs_50
+      signature PP_STREAM = gs_32
+      src/pp-desc-fn.sml
+   in
+      functor gs_52 = PPDescFn
+   end
+   local
+      structure CharBuffer = gs_34
+      signature DEVICE_OPS = gs_42
+      functor DefaultDeviceFn = gs_43
+      signature PP_DEVICE = gs_39
+      structure StringCvt = gs_41
+      devices/char-buffer-dev.sml
+   in
+      structure gs_53 = CharBufferDev
+   end
+   local
+      structure CharBuffer = gs_34
+      structure CharBufferDev = gs_53
+      functor PPStreamFn = gs_40
+      signature PP_STREAM = gs_32
+      structure StringToken = gs_31
+      devices/char-buffer-pp.sml
+   in
+      structure gs_54 = CharBufferPP
+   end
+   local
+      signature DEVICE_OPS = gs_42
+      functor DefaultDeviceFn = gs_43
+      signature PP_DEVICE = gs_39
+      structure StringCvt = gs_41
+      structure TextIO = gs_33
+      devices/simple-textio-dev.sml
+   in
+      structure gs_55 = SimpleTextIODev
+   end
+   local
+      functor PPStreamFn = gs_40
+      signature PP_STREAM = gs_32
+      structure SimpleTextIODev = gs_55
+      structure StringToken = gs_31
+      structure TextIO = gs_33
+      devices/textio-pp.sml
+   in
+      structure gs_56 = TextIOPP
+   end
+in
+   structure ANSITermDev = gs_48
+   structure ANSITermPP = gs_49
+   structure CharBufferPP = gs_54
+   functor PPDebugFn = gs_51
+   functor PPDescFn = gs_52
+   functor PPStreamFn = gs_40
+   signature PP_DESC = gs_50
+   signature PP_DEVICE = gs_39
+   signature PP_STREAM = gs_32
+   signature PP_TOKEN = gs_0
+   structure SimpleTextIODev = gs_55
+   structure StringToken = gs_31
+   structure TextIOPP = gs_56
+   structure TextPP = gs_44
+end
+end
+
+end
diff --git a/README.mlton b/README.mlton
new file mode 100644
index 0000000..12227d0
--- /dev/null
+++ b/README.mlton
@@ -0,0 +1,17 @@
+The following changes were made to the SML/NJ Library, in addition to
+deriving the `.mlb` files from the `.cm` files:
+
+* `Compat/either` (added): Implements `signature EITHER` and `structure Either: EITHER` (see https://github.com/SMLFamily/BasisLibrary/wiki/2015-002-Addition-of-Either-module); used by RegExp Library.
+* `Compat/fn` (added): Implements `signature FN` and `structure Fn: FN` (see https://github.com/SMLFamily/BasisLibrary/wiki/2015-005-Addition-of-Fn-module); used by JSON Library.
+* `Compat/mono-buffer` (added): Implements `signature MONO_BUFFER` and `structure CharBuffer: MONO_BUFFER` (see https://github.com/SMLFamily/BasisLibrary/wiki/2018-001-Addition-of-monomorphic-buffers); used by JSON and PP Libraries.
+* `Compat/mono-sequence` (added): Implements `signature MONO_{ARRAY,VECTOR}{,_SLICE}_EXT` and `structure Word8Slice: MONO_VECTOR_SLICE_EXT` (see https://github.com/SMLFamily/BasisLibrary/wiki/2015-003-Additional-operations-on-sequences and
+https://github.com/SMLFamily/BasisLibrary/wiki/2018-001-Addition-of-monomorphic-buffers); used by SML/NJ Library.
+* `HTML4/pp-init.sml` (added): Implements `structure PrettyPrint` using the SML/NJ PP Library.  This implementation is taken from the SML/NJ compiler source, since the SML/NJ HTML4 Library used the `structure PrettyPrint` provided by the SML/NJ compiler itself.
+* `JSON/json-stream-parser.sml` and `JSON/json-parser.sml` (modified): Rewrote use of `Unsafe.CharVector.create` and `Unsafe.CharVector.update`; MLton assumes that vectors are immutable.
+* `Util/base64.sml` (modified): Rewrote use of `Unsafe.CharVector.create` and `Unsafe.CharVector.update`; MLton assumes that vectors are immutable.
+* `Util/dynamic-array.sml` (modified): Rewrote use of `Array.fromVector`.
+* `Util/engine.mlton.sml` (added, not exported): Implements `structure Engine`, providing time-limited, resumable computations using <:MLtonThread:>, <:MLtonSignal:>, and <:MLtonItimer:>.
+* `Util/graph-scc-fn.sml` (modified): Rewrote use of `where` structure specification.
+* `Util/time-limit.mlb` (added): Exports `structure TimeLimit`, which is _not_ exported by `smlnj-lib.mlb`.  Since MLton is very conservative in the presence of threads and signals, program performance may be adversely affected by unnecessarily including `structure TimeLimit`.
+* `Util/time-limit.mlton.sml` (added): Implements `structure TimeLimit` using `structure Engine`.  The SML/NJ implementation of `structure TimeLimit` uses SML/NJ's first-class continuations, signals, and interval timer.
+* `Util/utf8.sml` (modified): Rewrote use of `String.implodeRev` (see https://github.com/SMLFamily/BasisLibrary/wiki/2015-003d-STRING).
diff --git a/Reactive/reactive-lib.mlb b/Reactive/reactive-lib.mlb
new file mode 100644
index 0000000..b082ba7
--- /dev/null
+++ b/Reactive/reactive-lib.mlb
@@ -0,0 +1,72 @@
+
+ann
+  "nonexhaustiveBind warn" "nonexhaustiveMatch warn"
+  "redundantBind warn" "redundantMatch warn"
+  "sequenceNonUnit ignore"
+  "warnUnused false" "forceUsed"
+in
+
+local
+  basis l8 =
+    bas
+      (* $/basis.cm ====> *) $(SML_LIB)/basis/basis.mlb $(SML_LIB)/basis/sml-nj.mlb
+    end
+  basis l4 =
+    bas
+      (* $/smlnj-lib.cm ====> *) $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
+    end
+in
+local
+   $(SML_LIB)/basis/pervasive.mlb
+   local
+      open l4
+   in
+      structure gs_0 = AtomBinaryMap
+   end
+   local
+      open l8
+   in
+      structure gs_1 = List
+   end
+   local
+      open l4
+   in
+      structure gs_2 = Atom
+   end
+   local
+      structure Atom = gs_2
+      reactive-sig.sml
+   in
+      signature gs_3 = REACTIVE
+   end
+   local
+      structure Atom = gs_2
+      instruction.sml
+   in
+      structure gs_4 = Instruction
+   end
+   local
+      structure Atom = gs_2
+      structure Instruction = gs_4
+      structure List = gs_1
+      machine.sml
+   in
+      structure gs_5 = Machine
+   end
+   local
+      structure AtomBinaryMap = gs_0
+      structure Instruction = gs_4
+      structure List = gs_1
+      structure Machine = gs_5
+      signature REACTIVE = gs_3
+      reactive.sml
+   in
+      structure gs_6 = Reactive
+   end
+in
+   signature REACTIVE = gs_3
+   structure Reactive = gs_6
+end
+end
+
+end
diff --git a/RegExp/regexp-lib.mlb b/RegExp/regexp-lib.mlb
new file mode 100644
index 0000000..aa152f9
--- /dev/null
+++ b/RegExp/regexp-lib.mlb
@@ -0,0 +1,342 @@
+
+ann
+  "nonexhaustiveBind ignore" "nonexhaustiveMatch ignore"
+  "redundantBind warn" "redundantMatch warn"
+  "sequenceNonUnit ignore"
+  "warnUnused false" "forceUsed"
+in
+
+local
+  basis l4 =
+    bas
+      (* $/basis.cm ====> *) $(SML_LIB)/basis/basis.mlb $(SML_LIB)/basis/sml-nj.mlb $(SML_LIB)/smlnj-lib/Compat/either/sources.mlb
+    end
+  basis l16 =
+    bas
+      (* $/smlnj-lib.cm ====> *) $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
+    end
+in
+local
+   $(SML_LIB)/basis/pervasive.mlb
+   local
+      open l4
+   in
+      structure gs_0 = Either
+   end
+   local
+      open l4
+   in
+      structure gs_1 = List
+   end
+   local
+      structure Either = gs_0
+      structure List = gs_1
+      Glue/match-tree.sml
+   in
+      signature gs_2 = MATCH_TREE
+      structure gs_3 = MatchTree
+   end
+   local
+      open l16
+   in
+      signature gs_4 = ORD_SET
+   end
+   local
+      signature ORD_SET = gs_4
+      FrontEnd/syntax-sig.sml
+   in
+      signature gs_5 = REGEXP_SYNTAX
+   end
+   local
+      open l4
+   in
+      structure gs_6 = Option
+   end
+   local
+      open l4
+   in
+      structure gs_7 = StringCvt
+   end
+   local
+      open l16
+   in
+      functor gs_8 = ListSetFn
+   end
+   local
+      open l4
+   in
+      structure gs_9 = Char
+      structure gs_10 = CharArray
+      structure gs_11 = CharVector
+      structure gs_12 = FixedInt
+      structure gs_13 = General
+      structure gs_14 = Int
+      structure gs_15 = Int32
+      structure gs_16 = Int64
+      structure gs_17 = IntInf
+      structure gs_18 = LargeInt
+      structure gs_19 = LargeReal
+      structure gs_20 = LargeWord
+      structure gs_21 = OS
+      structure gs_22 = Position
+      structure gs_23 = Real
+      structure gs_24 = Real64
+      structure gs_25 = RealArray
+      structure gs_26 = RealArraySlice
+      structure gs_27 = RealVector
+      structure gs_28 = RealVectorSlice
+      structure gs_29 = SMLofNJ
+      structure gs_30 = Socket
+      structure gs_31 = String
+      structure gs_32 = Substring
+      structure gs_33 = SysWord
+      structure gs_34 = Time
+      structure gs_35 = Word
+      structure gs_36 = Word32
+      structure gs_37 = Word64
+      structure gs_38 = Word8
+   end
+   local
+      structure Char = gs_9
+      structure CharArray = gs_10
+      structure CharVector = gs_11
+      structure FixedInt = gs_12
+      structure General = gs_13
+      structure Int = gs_14
+      structure Int32 = gs_15
+      structure Int64 = gs_16
+      structure IntInf = gs_17
+      structure LargeInt = gs_18
+      structure LargeReal = gs_19
+      structure LargeWord = gs_20
+      structure List = gs_1
+      functor ListSetFn = gs_8
+      structure OS = gs_21
+      structure Position = gs_22
+      signature REGEXP_SYNTAX = gs_5
+      structure Real = gs_23
+      structure Real64 = gs_24
+      structure RealArray = gs_25
+      structure RealArraySlice = gs_26
+      structure RealVector = gs_27
+      structure RealVectorSlice = gs_28
+      structure SMLofNJ = gs_29
+      structure Socket = gs_30
+      structure String = gs_31
+      structure Substring = gs_32
+      structure SysWord = gs_33
+      structure Time = gs_34
+      structure Word = gs_35
+      structure Word32 = gs_36
+      structure Word64 = gs_37
+      structure Word8 = gs_38
+      FrontEnd/syntax.sml
+   in
+      structure gs_39 = RegExpSyntax
+   end
+   local
+      signature MATCH_TREE = gs_2
+      structure MatchTree = gs_3
+      structure RegExpSyntax = gs_39
+      structure StringCvt = gs_7
+      BackEnd/engine-sig.sml
+   in
+      signature gs_40 = REGEXP_ENGINE
+   end
+   local
+      structure List = gs_1
+      signature MATCH_TREE = gs_2
+      structure MatchTree = gs_3
+      structure Option = gs_6
+      signature REGEXP_ENGINE = gs_40
+      structure RegExpSyntax = gs_39
+      BackEnd/bt-engine.sml
+   in
+      structure gs_41 = BackTrackEngine
+   end
+   local
+      signature MATCH_TREE = gs_2
+      structure MatchTree = gs_3
+      structure StringCvt = gs_7
+      Glue/regexp-sig.sml
+   in
+      signature gs_42 = REGEXP
+   end
+   local
+      structure RegExpSyntax = gs_39
+      structure StringCvt = gs_7
+      FrontEnd/parser-sig.sml
+   in
+      signature gs_43 = REGEXP_PARSER
+   end
+   local
+      signature MATCH_TREE = gs_2
+      structure MatchTree = gs_3
+      signature REGEXP = gs_42
+      signature REGEXP_ENGINE = gs_40
+      signature REGEXP_PARSER = gs_43
+      structure StringCvt = gs_7
+      Glue/regexp-fn.sml
+   in
+      functor gs_44 = RegExpFn
+   end
+   local
+      open l4
+   in
+      structure gs_45 = Vector
+   end
+   local
+      open l4
+   in
+      structure gs_46 = Array
+   end
+   local
+      structure Array = gs_46
+      structure List = gs_1
+      signature MATCH_TREE = gs_2
+      structure MatchTree = gs_3
+      signature REGEXP_ENGINE = gs_40
+      structure RegExpSyntax = gs_39
+      structure StringCvt = gs_7
+      structure Vector = gs_45
+      BackEnd/thompson-engine.sml
+   in
+      structure gs_47 = ThompsonEngine
+   end
+   local
+      open l16
+   in
+      functor gs_48 = ListMapFn
+   end
+   local
+      open l4
+   in
+      structure gs_49 = Array2
+   end
+   local
+      open l4
+   in
+      structure gs_50 = TextIO
+   end
+   local
+      open l4
+   in
+      structure gs_51 = ListPair
+   end
+   local
+      structure Array = gs_46
+      structure Array2 = gs_49
+      structure Char = gs_9
+      structure CharArray = gs_10
+      structure CharVector = gs_11
+      structure FixedInt = gs_12
+      structure General = gs_13
+      structure Int = gs_14
+      structure Int32 = gs_15
+      structure Int64 = gs_16
+      structure IntInf = gs_17
+      structure LargeInt = gs_18
+      structure LargeReal = gs_19
+      structure LargeWord = gs_20
+      structure List = gs_1
+      functor ListMapFn = gs_48
+      structure ListPair = gs_51
+      functor ListSetFn = gs_8
+      signature ORD_SET = gs_4
+      structure OS = gs_21
+      structure Position = gs_22
+      structure Real = gs_23
+      structure Real64 = gs_24
+      structure RealArray = gs_25
+      structure RealArraySlice = gs_26
+      structure RealVector = gs_27
+      structure RealVectorSlice = gs_28
+      structure RegExpSyntax = gs_39
+      structure SMLofNJ = gs_29
+      structure Socket = gs_30
+      structure String = gs_31
+      structure Substring = gs_32
+      structure SysWord = gs_33
+      structure TextIO = gs_50
+      structure Time = gs_34
+      structure Word = gs_35
+      structure Word32 = gs_36
+      structure Word64 = gs_37
+      structure Word8 = gs_38
+      BackEnd/fsm.sml
+   in
+      signature gs_52 = DFA
+      structure gs_53 = Dfa
+      signature gs_54 = NFA
+      structure gs_55 = Nfa
+   end
+   local
+      signature DFA = gs_52
+      structure Dfa = gs_53
+      signature MATCH_TREE = gs_2
+      structure MatchTree = gs_3
+      signature NFA = gs_54
+      structure Nfa = gs_55
+      signature REGEXP_ENGINE = gs_40
+      structure RegExpSyntax = gs_39
+      structure Vector = gs_45
+      BackEnd/dfa-engine.sml
+   in
+      structure gs_56 = DfaEngine
+   end
+   local
+      structure Char = gs_9
+      structure CharArray = gs_10
+      structure CharVector = gs_11
+      structure FixedInt = gs_12
+      structure General = gs_13
+      structure Int = gs_14
+      structure Int32 = gs_15
+      structure Int64 = gs_16
+      structure IntInf = gs_17
+      structure LargeInt = gs_18
+      structure LargeReal = gs_19
+      structure LargeWord = gs_20
+      structure List = gs_1
+      structure OS = gs_21
+      structure Position = gs_22
+      signature REGEXP_PARSER = gs_43
+      structure Real = gs_23
+      structure Real64 = gs_24
+      structure RealArray = gs_25
+      structure RealArraySlice = gs_26
+      structure RealVector = gs_27
+      structure RealVectorSlice = gs_28
+      structure RegExpSyntax = gs_39
+      structure SMLofNJ = gs_29
+      structure Socket = gs_30
+      structure String = gs_31
+      structure StringCvt = gs_7
+      structure Substring = gs_32
+      structure SysWord = gs_33
+      structure Time = gs_34
+      structure Word = gs_35
+      structure Word32 = gs_36
+      structure Word64 = gs_37
+      structure Word8 = gs_38
+      FrontEnd/awk-syntax.sml
+   in
+      structure gs_57 = AwkSyntax
+   end
+in
+   structure AwkSyntax = gs_57
+   structure BackTrackEngine = gs_41
+   structure DfaEngine = gs_56
+   signature MATCH_TREE = gs_2
+   structure MatchTree = gs_3
+   signature REGEXP = gs_42
+   signature REGEXP_ENGINE = gs_40
+   signature REGEXP_PARSER = gs_43
+   signature REGEXP_SYNTAX = gs_5
+   functor RegExpFn = gs_44
+   structure RegExpSyntax = gs_39
+   structure ThompsonEngine = gs_47
+end
+end
+
+end
diff --git a/SExp/sexp-lib.mlb b/SExp/sexp-lib.mlb
index dcf8e53..b574dc8 100644
--- a/SExp/sexp-lib.mlb
+++ b/SExp/sexp-lib.mlb
@@ -1,50 +1,314 @@
-(* sexp-lib.mlb
- *
- * COPYRIGHT (c) 2022 The Fellowship of SML/NJ (http://www.smlnj.org)
- * All rights reserved.
- *
- * Author: Damon Wang (with modifications by John Reppy)
- *
- * An MLB file for the JSON library, so that it can be used by MLton programs.
- *)
-
-local
-
-  $(SML_LIB)/basis/basis.mlb
-  $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
-  $(SML_LIB)/smlnj-lib/PP/pp-lib.mlb
-  $(SML_LIB)/mllpt-lib/mllpt-lib.mlb
-
-  ann
-    "nonexhaustiveMatch warn" "redundantMatch warn"
-    "sequenceNonUnit ignore"
-    "warnUnused false" "forceUsed"
-  in
-
-    sexp-tokens.sml
-    sexp.lex.sml
-    sexp.sml
-(*    sexp-stream-parser.sml *)
-    sexp-parser.sml
-    sexp-string-util.sml
-(*    sexp-stream-printer.sml *)
-    sexp-pp.sml
-    sexp-printer.sml
-
-  end
 
+ann
+  "nonexhaustiveBind ignore" "nonexhaustiveMatch warn"
+  "redundantBind warn" "redundantMatch warn"
+  "sequenceNonUnit ignore"
+  "warnUnused false" "forceUsed"
 in
 
-(* DOM-style API (tree based) *)
-  structure SExp
-  structure SExpParser
-  structure SExpPP
-  structure SExpPrinter
-
-(* SAX-style API (event based) *)
-(* TODO
-  structure SExpStreamParser
-  structure SExpStreamPrinter
-*)
+local
+  basis l4 =
+    bas
+      (* $/basis.cm ====> *) $(SML_LIB)/basis/basis.mlb $(SML_LIB)/basis/sml-nj.mlb
+    end
+  basis l8 =
+    bas
+      (* $/smlnj-lib.cm ====> *) $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
+    end
+  basis l93 =
+    bas
+      (* $/pp-lib.cm ====> *) $(SML_LIB)/smlnj-lib/PP/pp-lib.mlb
+    end
+  basis l15 =
+    bas
+      (* $/ml-lpt-lib.cm ====> *) $(SML_LIB)/mllpt-lib/mllpt-lib.mlb
+    end
+in
+local
+   $(SML_LIB)/basis/pervasive.mlb
+   local
+      open l4
+   in
+      structure gs_0 = TextIO
+   end
+   local
+      open l8
+   in
+      structure gs_1 = Atom
+   end
+   local
+      open l4
+   in
+      structure gs_2 = List
+   end
+   local
+      open l15
+   in
+      structure gs_3 = AntlrStreamPos
+   end
+   local
+      open l4
+   in
+      structure gs_4 = Char
+      structure gs_5 = CharArray
+      structure gs_6 = CharVector
+      structure gs_7 = FixedInt
+      structure gs_8 = General
+      structure gs_9 = Int
+      structure gs_10 = Int32
+      structure gs_11 = Int64
+      structure gs_12 = IntInf
+      structure gs_13 = LargeInt
+      structure gs_14 = LargeReal
+      structure gs_15 = LargeWord
+      structure gs_16 = OS
+      structure gs_17 = Position
+      structure gs_18 = Real
+      structure gs_19 = Real64
+      structure gs_20 = RealArray
+      structure gs_21 = RealArraySlice
+      structure gs_22 = RealVector
+      structure gs_23 = RealVectorSlice
+      structure gs_24 = SMLofNJ
+      structure gs_25 = Socket
+      structure gs_26 = String
+      structure gs_27 = Substring
+      structure gs_28 = SysWord
+      structure gs_29 = Time
+      structure gs_30 = Word
+      structure gs_31 = Word32
+      structure gs_32 = Word64
+      structure gs_33 = Word8
+   end
+   local
+      open l15
+   in
+      structure gs_34 = UTF8
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_2
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure UTF8 = gs_34
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      sexp-tokens.sml
+   in
+      structure gs_35 = SExpTokens
+   end
+   local
+      open l4
+   in
+      structure gs_36 = Vector
+   end
+   local
+      open l4
+   in
+      structure gs_37 = StringCvt
+   end
+   local
+      open l15
+   in
+      structure gs_38 = ULexBuffer
+   end
+   local
+      structure AntlrStreamPos = gs_3
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_2
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SExpTokens = gs_35
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure StringCvt = gs_37
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure TextIO = gs_0
+      structure Time = gs_29
+      structure ULexBuffer = gs_38
+      structure UTF8 = gs_34
+      structure Vector = gs_36
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      sexp.lex.sml
+   in
+      structure gs_39 = SExpLexer
+   end
+   local
+      open l4
+   in
+      structure gs_40 = ListPair
+   end
+   local
+      structure Atom = gs_1
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_2
+      structure ListPair = gs_40
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      sexp.sml
+   in
+      structure gs_41 = SExp
+   end
+   local
+      structure AntlrStreamPos = gs_3
+      structure Atom = gs_1
+      structure List = gs_2
+      structure SExp = gs_41
+      structure SExpLexer = gs_39
+      structure SExpTokens = gs_35
+      structure TextIO = gs_0
+      sexp-parser.sml
+   in
+      structure gs_42 = SExpParser
+   end
+   local
+      open l8
+   in
+      structure gs_43 = Format
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure StringCvt = gs_37
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      sexp-string-util.sml
+   in
+      structure gs_44 = SExpStringUtil
+   end
+   local
+      structure Atom = gs_1
+      structure Format = gs_43
+      structure List = gs_2
+      structure SExp = gs_41
+      structure SExpStringUtil = gs_44
+      structure TextIO = gs_0
+      sexp-printer.sml
+   in
+      structure gs_45 = SExpPrinter
+   end
+   local
+      open l93
+   in
+      structure gs_46 = TextIOPP
+   end
+   local
+      structure Atom = gs_1
+      structure Format = gs_43
+      structure List = gs_2
+      structure SExp = gs_41
+      structure SExpStringUtil = gs_44
+      structure TextIOPP = gs_46
+      sexp-pp.sml
+   in
+      structure gs_47 = SExpPP
+   end
+in
+   structure SExp = gs_41
+   structure SExpPP = gs_47
+   structure SExpParser = gs_42
+   structure SExpPrinter = gs_45
+end
+end
 
 end
diff --git a/UUID/uuid-lib.mlb b/UUID/uuid-lib.mlb
new file mode 100644
index 0000000..88c21b3
--- /dev/null
+++ b/UUID/uuid-lib.mlb
@@ -0,0 +1,163 @@
+
+ann
+  "nonexhaustiveBind warn" "nonexhaustiveMatch warn"
+  "redundantBind warn" "redundantMatch warn"
+  "sequenceNonUnit ignore"
+  "warnUnused false" "forceUsed"
+in
+
+local
+  basis l4 =
+    bas
+      (* $/basis.cm ====> *) $(SML_LIB)/basis/basis.mlb $(SML_LIB)/basis/sml-nj.mlb
+    end
+  basis l8 =
+    bas
+      (* $/smlnj-lib.cm ====> *) $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
+    end
+in
+local
+   $(SML_LIB)/basis/pervasive.mlb
+   local
+      open l4
+   in
+      structure gs_0 = Word8Vector
+   end
+   local
+      open l8
+   in
+      structure gs_1 = Random
+   end
+   local
+      open l4
+   in
+      structure gs_2 = Char
+      structure gs_3 = CharArray
+      structure gs_4 = CharVector
+      structure gs_5 = FixedInt
+      structure gs_6 = General
+      structure gs_7 = Int
+      structure gs_8 = Int32
+      structure gs_9 = Int64
+      structure gs_10 = IntInf
+      structure gs_11 = LargeInt
+      structure gs_12 = LargeReal
+      structure gs_13 = LargeWord
+      structure gs_14 = OS
+      structure gs_15 = Position
+      structure gs_16 = Real
+      structure gs_17 = Real64
+      structure gs_18 = RealArray
+      structure gs_19 = RealArraySlice
+      structure gs_20 = RealVector
+      structure gs_21 = RealVectorSlice
+      structure gs_22 = SMLofNJ
+      structure gs_23 = Socket
+      structure gs_24 = String
+      structure gs_25 = Substring
+      structure gs_26 = SysWord
+      structure gs_27 = Time
+      structure gs_28 = Word
+      structure gs_29 = Word32
+      structure gs_30 = Word64
+      structure gs_31 = Word8
+   end
+   local
+      open l4
+   in
+      structure gs_32 = Word8VectorSlice
+   end
+   local
+      open l4
+   in
+      structure gs_33 = List
+   end
+   local
+      open l4
+   in
+      structure gs_34 = StringCvt
+   end
+   local
+      structure Char = gs_2
+      structure CharArray = gs_3
+      structure CharVector = gs_4
+      structure FixedInt = gs_5
+      structure General = gs_6
+      structure Int = gs_7
+      structure Int32 = gs_8
+      structure Int64 = gs_9
+      structure IntInf = gs_10
+      structure LargeInt = gs_11
+      structure LargeReal = gs_12
+      structure LargeWord = gs_13
+      structure List = gs_33
+      structure OS = gs_14
+      structure Position = gs_15
+      structure Real = gs_16
+      structure Real64 = gs_17
+      structure RealArray = gs_18
+      structure RealArraySlice = gs_19
+      structure RealVector = gs_20
+      structure RealVectorSlice = gs_21
+      structure SMLofNJ = gs_22
+      structure Socket = gs_23
+      structure String = gs_24
+      structure StringCvt = gs_34
+      structure Substring = gs_25
+      structure SysWord = gs_26
+      structure Time = gs_27
+      structure Word = gs_28
+      structure Word32 = gs_29
+      structure Word64 = gs_30
+      structure Word8 = gs_31
+      structure Word8Vector = gs_0
+      structure Word8VectorSlice = gs_32
+      uuid.sml
+   in
+      structure gs_35 = UUID
+   end
+   local
+      structure Char = gs_2
+      structure CharArray = gs_3
+      structure CharVector = gs_4
+      structure FixedInt = gs_5
+      structure General = gs_6
+      structure Int = gs_7
+      structure Int32 = gs_8
+      structure Int64 = gs_9
+      structure IntInf = gs_10
+      structure LargeInt = gs_11
+      structure LargeReal = gs_12
+      structure LargeWord = gs_13
+      structure OS = gs_14
+      structure Position = gs_15
+      structure Random = gs_1
+      structure Real = gs_16
+      structure Real64 = gs_17
+      structure RealArray = gs_18
+      structure RealArraySlice = gs_19
+      structure RealVector = gs_20
+      structure RealVectorSlice = gs_21
+      structure SMLofNJ = gs_22
+      structure Socket = gs_23
+      structure String = gs_24
+      structure Substring = gs_25
+      structure SysWord = gs_26
+      structure Time = gs_27
+      structure UUID = gs_35
+      structure Word = gs_28
+      structure Word32 = gs_29
+      structure Word64 = gs_30
+      structure Word8 = gs_31
+      structure Word8Vector = gs_0
+      gen-uuid.sml
+   in
+      structure gs_36 = GenUUID
+   end
+in
+   structure GenUUID = gs_36
+   structure UUID = gs_35
+end
+end
+
+end
diff --git a/Unix/unix-lib.mlb b/Unix/unix-lib.mlb
new file mode 100644
index 0000000..00939f4
--- /dev/null
+++ b/Unix/unix-lib.mlb
@@ -0,0 +1,189 @@
+
+ann
+  "nonexhaustiveBind warn" "nonexhaustiveMatch warn"
+  "redundantBind warn" "redundantMatch warn"
+  "sequenceNonUnit ignore"
+  "warnUnused false" "forceUsed"
+in
+
+local
+  basis l8 =
+    bas
+      (* $/basis.cm ====> *) $(SML_LIB)/basis/basis.mlb $(SML_LIB)/basis/sml-nj.mlb
+    end
+  basis l4 =
+    bas
+      (* $/smlnj-lib.cm ====> *) $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
+    end
+in
+local
+   $(SML_LIB)/basis/pervasive.mlb
+   local
+      open l4
+   in
+      structure gs_0 = PathUtil
+   end
+   local
+      open l8
+   in
+      structure gs_1 = Posix
+   end
+   local
+      open l8
+   in
+      structure gs_2 = Char
+      structure gs_3 = CharArray
+      structure gs_4 = CharVector
+      structure gs_5 = FixedInt
+      structure gs_6 = General
+      structure gs_7 = Int
+      structure gs_8 = Int32
+      structure gs_9 = Int64
+      structure gs_10 = IntInf
+      structure gs_11 = LargeInt
+      structure gs_12 = LargeReal
+      structure gs_13 = LargeWord
+      structure gs_14 = OS
+      structure gs_15 = Position
+      structure gs_16 = Real
+      structure gs_17 = Real64
+      structure gs_18 = RealArray
+      structure gs_19 = RealArraySlice
+      structure gs_20 = RealVector
+      structure gs_21 = RealVectorSlice
+      structure gs_22 = SMLofNJ
+      structure gs_23 = Socket
+      structure gs_24 = String
+      structure gs_25 = Substring
+      structure gs_26 = SysWord
+      structure gs_27 = Time
+      structure gs_28 = Word
+      structure gs_29 = Word32
+      structure gs_30 = Word64
+      structure gs_31 = Word8
+   end
+   local
+      structure Char = gs_2
+      structure CharArray = gs_3
+      structure CharVector = gs_4
+      structure FixedInt = gs_5
+      structure General = gs_6
+      structure Int = gs_7
+      structure Int32 = gs_8
+      structure Int64 = gs_9
+      structure IntInf = gs_10
+      structure LargeInt = gs_11
+      structure LargeReal = gs_12
+      structure LargeWord = gs_13
+      structure OS = gs_14
+      structure Position = gs_15
+      structure Real = gs_16
+      structure Real64 = gs_17
+      structure RealArray = gs_18
+      structure RealArraySlice = gs_19
+      structure RealVector = gs_20
+      structure RealVectorSlice = gs_21
+      structure SMLofNJ = gs_22
+      structure Socket = gs_23
+      structure String = gs_24
+      structure Substring = gs_25
+      structure SysWord = gs_26
+      structure Time = gs_27
+      structure Word = gs_28
+      structure Word32 = gs_29
+      structure Word64 = gs_30
+      structure Word8 = gs_31
+      unix-path-sig.sml
+   in
+      signature gs_32 = UNIX_PATH
+   end
+   local
+      unix-env-sig.sml
+   in
+      signature gs_33 = UNIX_ENV
+   end
+   local
+      structure Char = gs_2
+      structure CharArray = gs_3
+      structure CharVector = gs_4
+      structure FixedInt = gs_5
+      structure General = gs_6
+      structure Int = gs_7
+      structure Int32 = gs_8
+      structure Int64 = gs_9
+      structure IntInf = gs_10
+      structure LargeInt = gs_11
+      structure LargeReal = gs_12
+      structure LargeWord = gs_13
+      structure OS = gs_14
+      structure Position = gs_15
+      structure Posix = gs_1
+      structure Real = gs_16
+      structure Real64 = gs_17
+      structure RealArray = gs_18
+      structure RealArraySlice = gs_19
+      structure RealVector = gs_20
+      structure RealVectorSlice = gs_21
+      structure SMLofNJ = gs_22
+      structure Socket = gs_23
+      structure String = gs_24
+      structure Substring = gs_25
+      structure SysWord = gs_26
+      structure Time = gs_27
+      signature UNIX_ENV = gs_33
+      structure Word = gs_28
+      structure Word32 = gs_29
+      structure Word64 = gs_30
+      structure Word8 = gs_31
+      unix-env.sml
+   in
+      structure gs_34 = UnixEnv
+   end
+   local
+      structure Char = gs_2
+      structure CharArray = gs_3
+      structure CharVector = gs_4
+      structure FixedInt = gs_5
+      structure General = gs_6
+      structure Int = gs_7
+      structure Int32 = gs_8
+      structure Int64 = gs_9
+      structure IntInf = gs_10
+      structure LargeInt = gs_11
+      structure LargeReal = gs_12
+      structure LargeWord = gs_13
+      structure OS = gs_14
+      structure PathUtil = gs_0
+      structure Position = gs_15
+      structure Posix = gs_1
+      structure Real = gs_16
+      structure Real64 = gs_17
+      structure RealArray = gs_18
+      structure RealArraySlice = gs_19
+      structure RealVector = gs_20
+      structure RealVectorSlice = gs_21
+      structure SMLofNJ = gs_22
+      structure Socket = gs_23
+      structure String = gs_24
+      structure Substring = gs_25
+      structure SysWord = gs_26
+      structure Time = gs_27
+      signature UNIX_PATH = gs_32
+      structure UnixEnv = gs_34
+      structure Word = gs_28
+      structure Word32 = gs_29
+      structure Word64 = gs_30
+      structure Word8 = gs_31
+      unix-path.sml
+   in
+      structure gs_35 = UnixPath
+   end
+in
+   signature UNIX_ENV = gs_33
+   signature UNIX_PATH = gs_32
+   structure UnixEnv = gs_34
+   structure UnixPath = gs_35
+end
+end
+
+end
diff --git a/Util/base64.sml b/Util/base64.sml
index 2432737..8e989c8 100644
--- a/Util/base64.sml
+++ b/Util/base64.sml
@@ -11,9 +11,11 @@
 structure Base64 : BASE64 =
   struct
 
+    structure CA = CharArray
     structure W8 = Word8
     structure W8V = Word8Vector
     structure W8A = Word8Array
+    structure UCA = Unsafe.CharArray
     structure UCV = Unsafe.CharVector
     structure UW8V = Unsafe.Word8Vector
 
@@ -59,16 +61,16 @@ structure Base64 : BASE64 =
     local
       fun encode64 (vec, start, len) = let
 	    val outLen = 4 * Int.quot(len + 2, 3)
-	    val outBuf = Unsafe.CharVector.create outLen
+	    val outBuf = UCA.create outLen
 	    val nTriples = Int.quot(len, 3)
 	    val extra = Int.rem(len, 3)
 	    fun insBuf (i, (c1, c2, c3, c4)) = let
 		  val idx = 4*i
 		  in
-		    UCV.update(outBuf, idx,   c1);
-		    UCV.update(outBuf, idx+1, c2);
-		    UCV.update(outBuf, idx+2, c3);
-		    UCV.update(outBuf, idx+3, c4)
+		    UCA.update(outBuf, idx,   c1);
+		    UCA.update(outBuf, idx+1, c2);
+		    UCA.update(outBuf, idx+2, c3);
+		    UCA.update(outBuf, idx+3, c4)
 		  end
 	    fun loop (i, idx) = if (i < nTriples)
 		  then (
@@ -81,7 +83,7 @@ structure Base64 : BASE64 =
 		    (* end case *))
 	    in
 	      loop (0, start);
-	      outBuf
+	      CA.vector outBuf
 	    end
     in
 
diff --git a/Util/dynamic-array.sml b/Util/dynamic-array.sml
index aea3e85..9601984 100644
--- a/Util/dynamic-array.sml
+++ b/Util/dynamic-array.sml
@@ -40,7 +40,7 @@ structure DynamicArray :> DYNAMIC_ARRAY =
 	  end
 
     fun fromVector (vec, dflt) = let
-	  val arr = A.fromVector vec
+	  val arr = A.tabulate (Vector.length vec, fn i => Vector.sub(vec, i))
 	  in
 	    BLOCK(ref arr, dflt, ref(Vector.length vec - 1))
 	  end
diff --git a/Util/engine.mlton.sml b/Util/engine.mlton.sml
new file mode 100644
index 0000000..696a2d0
--- /dev/null
+++ b/Util/engine.mlton.sml
@@ -0,0 +1,99 @@
+(* Copyright (C) 1999-2004 Henry Cejtin, Matthew Fluet, Suresh
+ *    Jagannathan, and Stephen Weeks.
+ *
+ * MLton is released under the GNU General Public License (GPL).
+ * Please see the file MLton-LICENSE for license information.
+ *)
+
+signature ENGINE =
+   sig
+      type 'a t
+
+      datatype 'a res =
+         Done of 'a
+       | Raise of exn
+       | TimeOut of 'a t
+
+      val new: (unit -> 'a) -> 'a t
+      val repeat: {thunk: unit -> 'a,
+                   limit: Time.time,
+                   tries: int} -> 'a option
+      val run: 'a t * Time.time -> 'a res
+      val timeLimit: Time.time * (unit -> 'a) -> 'a option
+   end
+
+structure Engine: ENGINE =
+struct
+
+open MLton
+
+datatype 'a t = T of {return: 'a res Thread.t option ref,
+                      thread: Thread.Runnable.t}
+and 'a res =
+   Done of 'a
+ | Raise of exn
+ | TimeOut of 'a t
+
+val which = Itimer.Real
+val signal = Itimer.signal which
+
+fun done (return): unit =
+   (return := NONE
+    ; Itimer.set (which, {value = Time.zeroTime,
+                          interval = Time.zeroTime})
+    ; Signal.setHandler (signal, Signal.Handler.default))
+
+fun new (f: unit -> 'a): 'a t =
+   let
+      val return = ref NONE
+      val thread =
+         Thread.new
+         (fn () =>
+          let
+             val res = Done (f ()) handle e => Raise e
+             val ret = valOf (!return)
+             val _ = done return
+          in
+             Thread.switch (fn _ => Thread.prepare (ret, res))
+          end)
+      val thread = Thread.prepare (thread, ())
+   in
+      T {return = return, thread = thread}
+   end
+
+fun run (T {return, thread}, time: Time.time): 'a res =
+   Thread.switch
+   (fn cur: 'a res Thread.t =>
+    let
+       val _ = return := SOME cur
+       fun handler (me: Thread.Runnable.t): Thread.Runnable.t =
+          Thread.prepare
+          (Thread.prepend (cur, fn () => (done return
+                                          ; TimeOut (T {return = return,
+                                                        thread = me}))),
+           ())
+       val _ = Signal.setHandler (signal, Signal.Handler.handler handler)
+       val _ = Itimer.set (which, {value = time,
+                                   interval = Time.zeroTime})
+    in
+       thread
+    end)
+
+fun timeLimit (t: Time.time, f: unit -> 'a): 'a option =
+   case run (new f, t) of
+      Done a => SOME a
+    | Raise e => raise e
+    | TimeOut _ => NONE
+
+fun repeat {thunk, limit, tries} =
+   let
+      fun loop (n: int) =
+         if n <= 0
+            then NONE
+         else (case timeLimit (limit, thunk) of
+                  NONE => loop (n - 1)
+                | SOME a => SOME a)
+   in loop tries
+   end
+
+end
diff --git a/Util/graph-scc-fn.sml b/Util/graph-scc-fn.sml
index da4c441..0e5e4eb 100644
--- a/Util/graph-scc-fn.sml
+++ b/Util/graph-scc-fn.sml
@@ -9,7 +9,7 @@
  * author: Matthias Blume
  *)
 
-functor GraphSCCFn (Nd: ORD_KEY) :> GRAPH_SCC where Nd = Nd =
+functor GraphSCCFn (Nd: ORD_KEY) :> GRAPH_SCC where type Nd.ord_key = Nd.ord_key =
   struct
     structure Nd = Nd
 
diff --git a/Util/smlnj-lib.mlb b/Util/smlnj-lib.mlb
new file mode 100644
index 0000000..ed2e22c
--- /dev/null
+++ b/Util/smlnj-lib.mlb
@@ -0,0 +1,2378 @@
+
+ann
+  "nonexhaustiveBind ignore" "nonexhaustiveMatch warn"
+  "redundantBind ignore" "redundantMatch warn"
+  "sequenceNonUnit ignore"
+  "warnUnused false" "forceUsed"
+in
+
+local
+  basis l4 =
+    bas
+      (* $/basis.cm ====> *) $(SML_LIB)/basis/basis.mlb $(SML_LIB)/basis/sml-nj.mlb $(SML_LIB)/basis/unsafe.mlb $(SML_LIB)/smlnj-lib/Compat/mono-buffer/sources.mlb $(SML_LIB)/smlnj-lib/Compat/mono-sequence/sources.mlb
+    end
+in
+local
+   $(SML_LIB)/basis/pervasive.mlb
+   local
+      open l4
+   in
+      structure gs_0 = StringCvt
+   end
+   local
+      structure StringCvt = gs_0
+      list-format-sig.sml
+   in
+      signature gs_1 = LIST_FORMAT
+   end
+   local
+      open l4
+   in
+      structure gs_2 = Array
+   end
+   local
+      open l4
+   in
+      structure gs_3 = Vector
+   end
+   local
+      open l4
+   in
+      structure gs_4 = Char
+      structure gs_5 = CharArray
+      structure gs_6 = CharVector
+      structure gs_7 = FixedInt
+      structure gs_8 = General
+      structure gs_9 = Int
+      structure gs_10 = Int32
+      structure gs_11 = Int64
+      structure gs_12 = IntInf
+      structure gs_13 = LargeInt
+      structure gs_14 = LargeReal
+      structure gs_15 = LargeWord
+      structure gs_16 = OS
+      structure gs_17 = Position
+      structure gs_18 = Real
+      structure gs_19 = Real64
+      structure gs_20 = RealArray
+      structure gs_21 = RealArraySlice
+      structure gs_22 = RealVector
+      structure gs_23 = RealVectorSlice
+      structure gs_24 = SMLofNJ
+      structure gs_25 = Socket
+      structure gs_26 = String
+      structure gs_27 = Substring
+      structure gs_28 = SysWord
+      structure gs_29 = Time
+      structure gs_30 = Word
+      structure gs_31 = Word32
+      structure gs_32 = Word64
+      structure gs_33 = Word8
+   end
+   local
+      open l4
+   in
+      structure gs_34 = List
+   end
+   local
+      open l4
+   in
+      structure gs_35 = ArraySlice
+   end
+   local
+      structure Vector = gs_3
+      dynamic-array-sig.sml
+   in
+      signature gs_36 = DYNAMIC_ARRAY
+   end
+   local
+      structure Array = gs_2
+      structure ArraySlice = gs_35
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      signature DYNAMIC_ARRAY = gs_36
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_34
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Vector = gs_3
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      dynamic-array.sml
+   in
+      structure gs_37 = DynamicArray
+   end
+   local
+      mono-priorityq-sig.sml
+   in
+      signature gs_38 = MONO_PRIORITYQ
+   end
+   local
+      priority-sig.sml
+   in
+      signature gs_39 = PRIORITY
+   end
+   local
+      structure List = gs_34
+      signature MONO_PRIORITYQ = gs_38
+      signature PRIORITY = gs_39
+      left-priorityq-fn.sml
+   in
+      functor gs_40 = LeftPriorityQFn
+   end
+   local
+      ord-key-sig.sml
+   in
+      signature gs_41 = ORD_KEY
+   end
+   local
+      signature ORD_KEY = gs_41
+      ord-map-sig.sml
+   in
+      signature gs_42 = ORD_MAP
+   end
+   local
+      lib-base-sig.sml
+   in
+      signature gs_43 = LIB_BASE
+   end
+   local
+      signature LIB_BASE = gs_43
+      lib-base.sml
+   in
+      structure gs_44 = LibBase
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure LibBase = gs_44
+      signature ORD_MAP = gs_42
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      int-redblack-map.sml
+   in
+      structure gs_45 = IntRedBlackMap
+   end
+   local
+      uref-sig.sml
+   in
+      signature gs_46 = UREF
+   end
+   local
+      signature UREF = gs_46
+      simple-uref.sml
+   in
+      structure gs_47 = SimpleURef
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure LibBase = gs_44
+      signature ORD_MAP = gs_42
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      int-binary-map.sml
+   in
+      structure gs_48 = IntBinaryMap
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      Target64Bit/native.sml
+   in
+      structure gs_49 = NativeInt
+      structure gs_50 = NativeWord
+   end
+   local
+      list-xprod-sig.sml
+   in
+      signature gs_51 = LIST_XPROD
+   end
+   local
+      signature LIST_XPROD = gs_51
+      list-xprod.sml
+   in
+      structure gs_52 = ListXProd
+   end
+   local
+      path-util-sig.sml
+   in
+      signature gs_53 = PATH_UTIL
+   end
+   local
+      open l4
+   in
+      structure gs_54 = Unsafe
+   end
+   local
+      open l4
+   in
+      structure gs_55 = Word8Vector
+   end
+   local
+      open l4
+   in
+      structure gs_56 = Word8Array
+   end
+   local
+      open l4
+   in
+      structure gs_57 = Byte
+   end
+   local
+      open l4
+   in
+      signature gs_58 = MONO_ARRAY
+   end
+   local
+      signature MONO_ARRAY = gs_58
+      bit-array-sig.sml
+   in
+      signature gs_59 = BIT_ARRAY
+   end
+   local
+      signature BIT_ARRAY = gs_59
+      structure Byte = gs_57
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure LibBase = gs_44
+      structure List = gs_34
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Unsafe = gs_54
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      structure Word8Array = gs_56
+      structure Word8Vector = gs_55
+      bit-array.sml
+   in
+      structure gs_60 = BitArray
+   end
+   local
+      signature ORD_KEY = gs_41
+      ord-set-sig.sml
+   in
+      signature gs_61 = ORD_SET
+   end
+   local
+      structure LibBase = gs_44
+      structure List = gs_34
+      signature ORD_KEY = gs_41
+      signature ORD_SET = gs_61
+      redblack-set-fn.sml
+   in
+      functor gs_62 = RedBlackSetFn
+   end
+   local
+      mono-dynamic-array-sig.sml
+   in
+      signature gs_63 = MONO_DYNAMIC_ARRAY
+   end
+   local
+      signature MONO_ARRAY = gs_58
+      bsearch-fn.sml
+   in
+      functor gs_64 = BSearchFn
+   end
+   local
+      open l4
+   in
+      structure gs_65 = Word8Buffer
+   end
+   local
+      open l4
+   in
+      structure gs_66 = Word8VectorSlice
+   end
+   local
+      structure NativeInt = gs_49
+      structure NativeWord = gs_50
+      structure Word8Vector = gs_55
+      random-sig.sml
+   in
+      signature gs_67 = RANDOM
+   end
+   local
+      open l4
+   in
+      structure gs_68 = Word8ArraySlice
+   end
+   local
+      structure Word8Vector = gs_55
+      structure Word8VectorSlice = gs_66
+      base64-sig.sml
+   in
+      signature gs_69 = BASE64
+   end
+   local
+      signature BASE64 = gs_69
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Unsafe = gs_54
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      structure Word8Array = gs_56
+      structure Word8ArraySlice = gs_68
+      structure Word8Vector = gs_55
+      structure Word8VectorSlice = gs_66
+      base64.sml
+   in
+      structure gs_70 = Base64
+   end
+   local
+      structure Array = gs_2
+      structure Base64 = gs_70
+      structure Byte = gs_57
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure LibBase = gs_44
+      structure List = gs_34
+      signature MONO_ARRAY = gs_58
+      structure OS = gs_16
+      structure Position = gs_17
+      signature RANDOM = gs_67
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      structure Word8Buffer = gs_65
+      structure Word8Vector = gs_55
+      structure Word8VectorSlice = gs_66
+      Target64Bit/random.sml
+   in
+      structure gs_71 = Random
+   end
+   local
+      structure Array = gs_2
+      structure ArraySlice = gs_35
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Random = gs_71
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Unsafe = gs_54
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      real-order-stats.sml
+   in
+      structure gs_72 = RealOrderStats
+   end
+   local
+      structure Array = gs_2
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Unsafe = gs_54
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      edit-distance.sml
+   in
+      structure gs_73 = EditDistance
+   end
+   local
+      atom-sig.sml
+   in
+      signature gs_74 = ATOM
+   end
+   local
+      open l4
+   in
+      structure gs_75 = TextIO
+   end
+   local
+      structure TextIO = gs_75
+      io-util-sig.sml
+   in
+      signature gs_76 = IO_UTIL
+   end
+   local
+      signature IO_UTIL = gs_76
+      structure TextIO = gs_75
+      io-util.sml
+   in
+      structure gs_77 = IOUtil
+   end
+   local
+      fifo-sig.sml
+   in
+      signature gs_78 = FIFO
+   end
+   local
+      hash-key-sig.sml
+   in
+      signature gs_79 = HASH_KEY
+   end
+   local
+      signature HASH_KEY = gs_79
+      mono-hash-table-sig.sml
+   in
+      signature gs_80 = MONO_HASH_TABLE
+   end
+   local
+      structure Array = gs_2
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      max-hash-table-size.sml
+   in
+      structure gs_81 = MaxHashTableSize
+   end
+   local
+      structure Array = gs_2
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure MaxHashTableSize = gs_81
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      hash-table-rep.sml
+   in
+      structure gs_82 = HashTableRep
+   end
+   local
+      structure Array = gs_2
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure HashTableRep = gs_82
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      signature MONO_HASH_TABLE = gs_80
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      int-hash-table.sml
+   in
+      structure gs_83 = IntHashTable
+   end
+   local
+      structure LibBase = gs_44
+      structure List = gs_34
+      signature ORD_KEY = gs_41
+      signature ORD_SET = gs_61
+      list-set-fn.sml
+   in
+      functor gs_84 = ListSetFn
+   end
+   local
+      open l4
+   in
+      structure gs_85 = Option
+   end
+   local
+      getopt-sig.sml
+   in
+      signature gs_86 = GET_OPT
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      signature GET_OPT = gs_86
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_34
+      structure OS = gs_16
+      structure Option = gs_85
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure StringCvt = gs_0
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      getopt.sml
+   in
+      structure gs_87 = GetOpt
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure LibBase = gs_44
+      structure List = gs_34
+      signature ORD_SET = gs_61
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      int-redblack-set.sml
+   in
+      structure gs_88 = IntRedBlackSet
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      signature PATH_UTIL = gs_53
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      path-util.sml
+   in
+      structure gs_89 = PathUtil
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure LibBase = gs_44
+      structure List = gs_34
+      signature ORD_SET = gs_61
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      int-list-set.sml
+   in
+      structure gs_90 = IntListSet
+   end
+   local
+      structure LibBase = gs_44
+      structure List = gs_34
+      signature ORD_KEY = gs_41
+      signature ORD_MAP = gs_42
+      list-map-fn.sml
+   in
+      functor gs_91 = ListMapFn
+   end
+   local
+      splaytree-sig.sml
+   in
+      signature gs_92 = SPLAY_TREE
+   end
+   local
+      signature MONO_ARRAY = gs_58
+      mono-array-sort-sig.sml
+   in
+      signature gs_93 = MONO_ARRAY_SORT
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      signature MONO_ARRAY = gs_58
+      signature MONO_ARRAY_SORT = gs_93
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      array-qsort-fn.sml
+   in
+      functor gs_94 = ArrayQSortFn
+   end
+   local
+      signature HASH_KEY = gs_79
+      mono-hash-set-sig.sml
+   in
+      signature gs_95 = MONO_HASH_SET
+   end
+   local
+      structure Array = gs_2
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      signature HASH_KEY = gs_79
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_34
+      signature MONO_HASH_SET = gs_95
+      structure MaxHashTableSize = gs_81
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      hash-set-fn.sml
+   in
+      functor gs_96 = HashSetFn
+   end
+   local
+      signature ORD_KEY = gs_41
+      graph-scc-sig.sml
+   in
+      signature gs_97 = GRAPH_SCC
+   end
+   local
+      structure LibBase = gs_44
+      signature ORD_KEY = gs_41
+      signature ORD_MAP = gs_42
+      redblack-map-fn.sml
+   in
+      functor gs_98 = RedBlackMapFn
+   end
+   local
+      signature GRAPH_SCC = gs_97
+      structure List = gs_34
+      signature ORD_KEY = gs_41
+      functor RedBlackMapFn = gs_98
+      graph-scc-fn.sml
+   in
+      functor gs_99 = GraphSCCFn
+   end
+   local
+      interval-domain-sig.sml
+   in
+      signature gs_100 = INTERVAL_DOMAIN
+   end
+   local
+      signature INTERVAL_DOMAIN = gs_100
+      interval-set-sig.sml
+   in
+      signature gs_101 = INTERVAL_SET
+   end
+   local
+      signature HASH_KEY = gs_79
+      mono-hash2-table-sig.sml
+   in
+      signature gs_102 = MONO_HASH2_TABLE
+   end
+   local
+      open l4
+   in
+      structure gs_103 = Bool
+   end
+   local
+      structure StringCvt = gs_0
+      format-comb-sig.sml
+   in
+      signature gs_104 = FORMAT_COMB
+   end
+   local
+      structure Bool = gs_103
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      signature FORMAT_COMB = gs_104
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_34
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure StringCvt = gs_0
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      format-comb.sml
+   in
+      structure gs_105 = FormatComb
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      fnv-hash.sml
+   in
+      structure gs_106 = FNVHash
+   end
+   local
+      signature ATOM = gs_74
+      structure Array = gs_2
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FNVHash = gs_106
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      atom.sml
+   in
+      structure gs_107 = Atom
+   end
+   local
+      structure LibBase = gs_44
+      signature ORD_KEY = gs_41
+      signature ORD_MAP = gs_42
+      binary-map-fn.sml
+   in
+      functor gs_108 = BinaryMapFn
+   end
+   local
+      signature FIFO = gs_78
+      structure List = gs_34
+      fifo.sml
+   in
+      structure gs_109 = Fifo
+   end
+   local
+      structure StringCvt = gs_0
+      parser-comb-sig.sml
+   in
+      signature gs_110 = PARSER_COMB
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      signature PARSER_COMB = gs_110
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure StringCvt = gs_0
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      parser-comb.sml
+   in
+      structure gs_111 = ParserComb
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure LibBase = gs_44
+      structure List = gs_34
+      signature ORD_SET = gs_61
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      int-binary-set.sml
+   in
+      structure gs_112 = IntBinarySet
+   end
+   local
+      structure Array = gs_2
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      signature HASH_KEY = gs_79
+      structure HashTableRep = gs_82
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      signature MONO_HASH_TABLE = gs_80
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      hash-table-fn.sml
+   in
+      functor gs_113 = HashTableFn
+   end
+   local
+      array-sort-sig.sml
+   in
+      signature gs_114 = ARRAY_SORT
+   end
+   local
+      signature ARRAY_SORT = gs_114
+      structure Array = gs_2
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Unsafe = gs_54
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      array-qsort.sml
+   in
+      structure gs_115 = ArrayQSort
+   end
+   local
+      structure Atom = gs_107
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      format-sig.sml
+   in
+      signature gs_116 = FORMAT
+   end
+   local
+      hash-table-sig.sml
+   in
+      signature gs_117 = HASH_TABLE
+   end
+   local
+      structure Atom = gs_107
+      functor HashTableFn = gs_113
+      atom-table.sml
+   in
+      structure gs_118 = AtomTable
+   end
+   local
+      char-map-sig.sml
+   in
+      signature gs_119 = CHAR_MAP
+   end
+   local
+      structure Atom = gs_107
+      functor RedBlackSetFn = gs_62
+      atom-redblack-set.sml
+   in
+      structure gs_120 = AtomRedBlackSet
+   end
+   local
+      structure AtomRedBlackSet = gs_120
+      atom-set.sml
+   in
+      structure gs_121 = AtomSet
+   end
+   local
+      queue-sig.sml
+   in
+      signature gs_122 = QUEUE
+   end
+   local
+      structure Fifo = gs_109
+      signature QUEUE = gs_122
+      queue.sml
+   in
+      structure gs_123 = Queue
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure LibBase = gs_44
+      signature ORD_MAP = gs_42
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      word-redblack-map.sml
+   in
+      structure gs_124 = WordRedBlackMap
+   end
+   local
+      structure Array = gs_2
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      signature HASH_TABLE = gs_117
+      structure HashTableRep = gs_82
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      hash-table.sml
+   in
+      structure gs_125 = HashTable
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure LibBase = gs_44
+      structure List = gs_34
+      signature ORD_MAP = gs_42
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      int-list-map.sml
+   in
+      structure gs_126 = IntListMap
+   end
+   local
+      signature SPLAY_TREE = gs_92
+      splaytree.sml
+   in
+      structure gs_127 = SplayTree
+   end
+   local
+      structure LibBase = gs_44
+      structure List = gs_34
+      signature ORD_KEY = gs_41
+      signature ORD_SET = gs_61
+      structure SplayTree = gs_127
+      splay-set-fn.sml
+   in
+      functor gs_128 = SplaySetFn
+   end
+   local
+      plist-sig.sml
+   in
+      signature gs_129 = PROP_LIST
+   end
+   local
+      structure List = gs_34
+      signature PROP_LIST = gs_129
+      plist.sml
+   in
+      structure gs_130 = PropList
+   end
+   local
+      structure Atom = gs_107
+      structure AtomTable = gs_118
+      structure List = gs_34
+      keyword-fn.sml
+   in
+      functor gs_131 = KeywordFn
+   end
+   local
+      open l4
+   in
+      structure gs_132 = Math
+   end
+   local
+      structure Array = gs_2
+      structure ArraySlice = gs_35
+      structure Math = gs_132
+      structure RealOrderStats = gs_72
+      structure Unsafe = gs_54
+      univariate-stats.sml
+   in
+      structure gs_133 = UnivariateStats
+   end
+   local
+      structure LibBase = gs_44
+      structure List = gs_34
+      signature ORD_KEY = gs_41
+      signature ORD_SET = gs_61
+      binary-set-fn.sml
+   in
+      functor gs_134 = BinarySetFn
+   end
+   local
+      structure Atom = gs_107
+      functor BinarySetFn = gs_134
+      atom-binary-set.sml
+   in
+      structure gs_135 = AtomBinarySet
+   end
+   local
+      structure Atom = gs_107
+      functor BinaryMapFn = gs_108
+      atom-binary-map.sml
+   in
+      structure gs_136 = AtomBinaryMap
+   end
+   local
+      Target64Bit/prime-sizes.sml
+   in
+      structure gs_137 = PrimeSizes
+   end
+   local
+      structure Atom = gs_107
+      functor RedBlackMapFn = gs_98
+      atom-redblack-map.sml
+   in
+      structure gs_138 = AtomRedBlackMap
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      rand-sig.sml
+   in
+      signature gs_139 = RAND
+   end
+   local
+      structure Array = gs_2
+      signature CHAR_MAP = gs_119
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_34
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Unsafe = gs_54
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      char-map.sml
+   in
+      structure gs_140 = CharMap
+   end
+   local
+      structure Array = gs_2
+      signature MONO_ARRAY = gs_58
+      structure Vector = gs_3
+      mono-array-fn.sml
+   in
+      functor gs_141 = MonoArrayFn
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure StringCvt = gs_0
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      real-format.sml
+   in
+      structure gs_142 = RealFormat
+   end
+   local
+      structure Atom = gs_107
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure StringCvt = gs_0
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      fmt-fields.sml
+   in
+      structure gs_143 = FmtFields
+   end
+   local
+      structure Atom = gs_107
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      signature FORMAT = gs_116
+      structure FixedInt = gs_7
+      structure FmtFields = gs_143
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealFormat = gs_142
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure StringCvt = gs_0
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      format.sml
+   in
+      structure gs_144 = Format
+   end
+   local
+      structure Atom = gs_107
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure StringCvt = gs_0
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      scan-sig.sml
+   in
+      signature gs_145 = SCAN
+   end
+   local
+      structure Bool = gs_103
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure FmtFields = gs_143
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      signature SCAN = gs_145
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure StringCvt = gs_0
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      structure Word8Array = gs_56
+      scan.sml
+   in
+      structure gs_146 = Scan
+   end
+   local
+      structure AtomRedBlackMap = gs_138
+      atom-map.sml
+   in
+      structure gs_147 = AtomMap
+   end
+   local
+      signature INTERVAL_DOMAIN = gs_100
+      signature INTERVAL_SET = gs_101
+      structure List = gs_34
+      interval-set-fn.sml
+   in
+      functor gs_148 = IntervalSetFn
+   end
+   local
+      structure Array = gs_2
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      signature HASH_KEY = gs_79
+      structure HashTableRep = gs_82
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      signature MONO_HASH2_TABLE = gs_102
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      hash2-table-fn.sml
+   in
+      functor gs_149 = Hash2TableFn
+   end
+   local
+      structure LibBase = gs_44
+      signature ORD_KEY = gs_41
+      signature ORD_MAP = gs_42
+      structure SplayTree = gs_127
+      splay-map-fn.sml
+   in
+      functor gs_150 = SplayMapFn
+   end
+   local
+      structure Array = gs_2
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure HashTableRep = gs_82
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      signature MONO_HASH_TABLE = gs_80
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      word-hash-table.sml
+   in
+      structure gs_151 = WordHashTable
+   end
+   local
+      structure StringCvt = gs_0
+      utf8-sig.sml
+   in
+      signature gs_152 = UTF8
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_34
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure StringCvt = gs_0
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      signature UTF8 = gs_152
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      utf8.sml
+   in
+      structure gs_153 = UTF8
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure LibBase = gs_44
+      structure OS = gs_16
+      structure Position = gs_17
+      signature RAND = gs_139
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      rand.sml
+   in
+      structure gs_154 = Rand
+   end
+   local
+      structure FNVHash = gs_106
+      hash-string.sml
+   in
+      structure gs_155 = HashString
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      signature LIST_FORMAT = gs_1
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure StringCvt = gs_0
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      list-format.sml
+   in
+      structure gs_156 = ListFormat
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_34
+      signature MONO_ARRAY = gs_58
+      signature MONO_DYNAMIC_ARRAY = gs_63
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      dynamic-array-fn.sml
+   in
+      functor gs_157 = DynamicArrayFn
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure LibBase = gs_44
+      structure List = gs_34
+      signature ORD_SET = gs_61
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      word-redblack-set.sml
+   in
+      structure gs_158 = WordRedBlackSet
+   end
+   local
+      listsort-sig.sml
+   in
+      signature gs_159 = LIST_SORT
+   end
+   local
+      signature LIST_SORT = gs_159
+      list-mergesort.sml
+   in
+      structure gs_160 = ListMergeSort
+   end
+   local
+      signature UREF = gs_46
+      uref.sml
+   in
+      structure gs_161 = URef
+   end
+   local
+      structure Char = gs_4
+      structure CharArray = gs_5
+      structure CharVector = gs_6
+      structure FixedInt = gs_7
+      structure General = gs_8
+      structure Int = gs_9
+      structure Int32 = gs_10
+      structure Int64 = gs_11
+      structure IntInf = gs_12
+      structure LargeInt = gs_13
+      structure LargeReal = gs_14
+      structure LargeWord = gs_15
+      structure List = gs_34
+      structure OS = gs_16
+      structure Position = gs_17
+      structure Real = gs_18
+      structure Real64 = gs_19
+      structure RealArray = gs_20
+      structure RealArraySlice = gs_21
+      structure RealVector = gs_22
+      structure RealVectorSlice = gs_23
+      structure SMLofNJ = gs_24
+      structure Socket = gs_25
+      structure String = gs_26
+      structure Substring = gs_27
+      structure SysWord = gs_28
+      structure TextIO = gs_75
+      structure Time = gs_29
+      structure Word = gs_30
+      structure Word32 = gs_31
+      structure Word64 = gs_32
+      structure Word8 = gs_33
+      ansi-term.sml
+   in
+      structure gs_162 = ANSITerm
+   end
+in
+   structure ANSITerm = gs_162
+   signature ARRAY_SORT = gs_114
+   signature ATOM = gs_74
+   structure ArrayQSort = gs_115
+   functor ArrayQSortFn = gs_94
+   structure Atom = gs_107
+   structure AtomBinaryMap = gs_136
+   structure AtomBinarySet = gs_135
+   structure AtomMap = gs_147
+   structure AtomRedBlackMap = gs_138
+   structure AtomRedBlackSet = gs_120
+   structure AtomSet = gs_121
+   structure AtomTable = gs_118
+   signature BASE64 = gs_69
+   signature BIT_ARRAY = gs_59
+   functor BSearchFn = gs_64
+   structure Base64 = gs_70
+   functor BinaryMapFn = gs_108
+   functor BinarySetFn = gs_134
+   structure BitArray = gs_60
+   signature CHAR_MAP = gs_119
+   structure CharMap = gs_140
+   signature DYNAMIC_ARRAY = gs_36
+   structure DynamicArray = gs_37
+   functor DynamicArrayFn = gs_157
+   structure EditDistance = gs_73
+   signature FIFO = gs_78
+   structure FNVHash = gs_106
+   signature FORMAT = gs_116
+   signature FORMAT_COMB = gs_104
+   structure Fifo = gs_109
+   structure Format = gs_144
+   structure FormatComb = gs_105
+   signature GET_OPT = gs_86
+   signature GRAPH_SCC = gs_97
+   structure GetOpt = gs_87
+   functor GraphSCCFn = gs_99
+   signature HASH_KEY = gs_79
+   signature HASH_TABLE = gs_117
+   functor Hash2TableFn = gs_149
+   functor HashSetFn = gs_96
+   structure HashString = gs_155
+   structure HashTable = gs_125
+   functor HashTableFn = gs_113
+   signature INTERVAL_DOMAIN = gs_100
+   signature INTERVAL_SET = gs_101
+   structure IOUtil = gs_77
+   signature IO_UTIL = gs_76
+   structure IntBinaryMap = gs_48
+   structure IntBinarySet = gs_112
+   structure IntHashTable = gs_83
+   structure IntListMap = gs_126
+   structure IntListSet = gs_90
+   structure IntRedBlackMap = gs_45
+   structure IntRedBlackSet = gs_88
+   functor IntervalSetFn = gs_148
+   functor KeywordFn = gs_131
+   signature LIB_BASE = gs_43
+   signature LIST_FORMAT = gs_1
+   signature LIST_SORT = gs_159
+   signature LIST_XPROD = gs_51
+   functor LeftPriorityQFn = gs_40
+   structure LibBase = gs_44
+   structure ListFormat = gs_156
+   functor ListMapFn = gs_91
+   structure ListMergeSort = gs_160
+   functor ListSetFn = gs_84
+   structure ListXProd = gs_52
+   signature MONO_ARRAY_SORT = gs_93
+   signature MONO_DYNAMIC_ARRAY = gs_63
+   signature MONO_HASH2_TABLE = gs_102
+   signature MONO_HASH_SET = gs_95
+   signature MONO_HASH_TABLE = gs_80
+   signature MONO_PRIORITYQ = gs_38
+   functor MonoArrayFn = gs_141
+   structure NativeInt = gs_49
+   structure NativeWord = gs_50
+   signature ORD_KEY = gs_41
+   signature ORD_MAP = gs_42
+   signature ORD_SET = gs_61
+   signature PARSER_COMB = gs_110
+   signature PATH_UTIL = gs_53
+   signature PRIORITY = gs_39
+   signature PROP_LIST = gs_129
+   structure ParserComb = gs_111
+   structure PathUtil = gs_89
+   structure PrimeSizes = gs_137
+   structure PropList = gs_130
+   signature QUEUE = gs_122
+   structure Queue = gs_123
+   signature RAND = gs_139
+   signature RANDOM = gs_67
+   structure Rand = gs_154
+   structure Random = gs_71
+   structure RealOrderStats = gs_72
+   functor RedBlackMapFn = gs_98
+   functor RedBlackSetFn = gs_62
+   signature SCAN = gs_145
+   signature SPLAY_TREE = gs_92
+   structure Scan = gs_146
+   structure SimpleURef = gs_47
+   functor SplayMapFn = gs_150
+   functor SplaySetFn = gs_128
+   signature UREF = gs_46
+   structure URef = gs_161
+   signature UTF8 = gs_152
+   structure UTF8 = gs_153
+   structure UnivariateStats = gs_133
+   structure WordHashTable = gs_151
+   structure WordRedBlackMap = gs_124
+   structure WordRedBlackSet = gs_158
+end
+end
+
+end
diff --git a/Util/time-limit.mlb b/Util/time-limit.mlb
new file mode 100644
index 0000000..c4ca078
--- /dev/null
+++ b/Util/time-limit.mlb
@@ -0,0 +1,16 @@
+ann
+  "nonexhaustiveMatch warn" "redundantMatch warn"
+  "sequenceNonUnit warn"
+  "warnUnused false" "forceUsed"
+in
+
+local
+  $(SML_LIB)/basis/basis.mlb
+  $(SML_LIB)/basis/mlton.mlb
+  engine.mlton.sml
+  time-limit.mlton.sml
+in
+  structure TimeLimit = TimeLimit
+end
+
+end
diff --git a/Util/time-limit.mlton.sml b/Util/time-limit.mlton.sml
new file mode 100644
index 0000000..0f585b7
--- /dev/null
+++ b/Util/time-limit.mlton.sml
@@ -0,0 +1,24 @@
+(* time-limit.mlton.sml
+ *
+ * Copyright (C) 1999-2004 Henry Cejtin, Matthew Fluet, Suresh
+ *    Jagannathan, and Stephen Weeks.
+ *
+ * MLton is released under the GNU General Public License (GPL).
+ * Please see the file MLton-LICENSE for license information.
+ *
+ *)
+
+structure TimeLimit:
+sig
+   exception TimeOut
+   val timeLimit : Time.time -> ('a -> 'b) -> 'a -> 'b
+end =
+struct
+   exception TimeOut
+
+   fun timeLimit t f x =
+      case Engine.run (Engine.new (fn () => f x), t) of
+	 Engine.Done res => res
+       | Engine.Raise exn => raise exn
+       | Engine.TimeOut _ => raise TimeOut
+end
diff --git a/Util/utf8.sml b/Util/utf8.sml
index 61c318d..7d97639 100644
--- a/Util/utf8.sml
+++ b/Util/utf8.sml
@@ -277,7 +277,7 @@ structure UTF8 :> UTF8 =
 
     fun map f s = let
 	  fun mapf (ss, chrs) = (case getWCFromSubstring ss
-		 of NONE => String.implodeRev chrs
+		 of NONE => String.implode (List.rev chrs)
 		  | SOME(wc, ss) => mapf (ss, List.revAppend(encode'(wc, []), chrs))
 		(* end case *))
 	  in
diff --git a/XML/xml-lib.mlb b/XML/xml-lib.mlb
new file mode 100644
index 0000000..b722d6d
--- /dev/null
+++ b/XML/xml-lib.mlb
@@ -0,0 +1,255 @@
+
+ann
+  "nonexhaustiveBind warn" "nonexhaustiveMatch warn"
+  "redundantBind warn" "redundantMatch warn"
+  "sequenceNonUnit ignore"
+  "warnUnused false" "forceUsed"
+in
+
+local
+  basis l8 =
+    bas
+      (* $/basis.cm ====> *) $(SML_LIB)/basis/basis.mlb $(SML_LIB)/basis/sml-nj.mlb
+    end
+  basis l78 =
+    bas
+      (* $/smlnj-lib.cm ====> *) $(SML_LIB)/smlnj-lib/Util/smlnj-lib.mlb
+    end
+  basis l47 =
+    bas
+      (* $/ml-lpt-lib.cm ====> *) $(SML_LIB)/mllpt-lib/mllpt-lib.mlb
+    end
+in
+local
+   $(SML_LIB)/basis/pervasive.mlb
+   local
+      xml-schema-sig.sml
+   in
+      signature gs_0 = XML_SCHEMA
+   end
+   local
+      open l8
+   in
+      structure gs_1 = TextIO
+   end
+   local
+      open l8
+   in
+      structure gs_2 = Char
+      structure gs_3 = CharArray
+      structure gs_4 = CharVector
+      structure gs_5 = FixedInt
+      structure gs_6 = General
+      structure gs_7 = Int
+      structure gs_8 = Int32
+      structure gs_9 = Int64
+      structure gs_10 = IntInf
+      structure gs_11 = LargeInt
+      structure gs_12 = LargeReal
+      structure gs_13 = LargeWord
+      structure gs_14 = OS
+      structure gs_15 = Position
+      structure gs_16 = Real
+      structure gs_17 = Real64
+      structure gs_18 = RealArray
+      structure gs_19 = RealArraySlice
+      structure gs_20 = RealVector
+      structure gs_21 = RealVectorSlice
+      structure gs_22 = SMLofNJ
+      structure gs_23 = Socket
+      structure gs_24 = String
+      structure gs_25 = Substring
+      structure gs_26 = SysWord
+      structure gs_27 = Time
+      structure gs_28 = Word
+      structure gs_29 = Word32
+      structure gs_30 = Word64
+      structure gs_31 = Word8
+   end
+   local
+      open l8
+   in
+      structure gs_32 = List
+   end
+   local
+      open l47
+   in
+      structure gs_33 = AntlrStreamPos
+   end
+   local
+      xml-tokens.sml
+   in
+      structure gs_34 = XMLTokens
+   end
+   local
+      open l8
+   in
+      structure gs_35 = Vector
+   end
+   local
+      open l8
+   in
+      structure gs_36 = Option
+   end
+   local
+      open l47
+   in
+      structure gs_37 = UTF8
+   end
+   local
+      open l47
+   in
+      structure gs_38 = ULexBuffer
+   end
+   local
+      structure AntlrStreamPos = gs_33
+      structure Char = gs_2
+      structure CharArray = gs_3
+      structure CharVector = gs_4
+      structure FixedInt = gs_5
+      structure General = gs_6
+      structure Int = gs_7
+      structure Int32 = gs_8
+      structure Int64 = gs_9
+      structure IntInf = gs_10
+      structure LargeInt = gs_11
+      structure LargeReal = gs_12
+      structure LargeWord = gs_13
+      structure List = gs_32
+      structure OS = gs_14
+      structure Option = gs_36
+      structure Position = gs_15
+      structure Real = gs_16
+      structure Real64 = gs_17
+      structure RealArray = gs_18
+      structure RealArraySlice = gs_19
+      structure RealVector = gs_20
+      structure RealVectorSlice = gs_21
+      structure SMLofNJ = gs_22
+      structure Socket = gs_23
+      structure String = gs_24
+      structure Substring = gs_25
+      structure SysWord = gs_26
+      structure TextIO = gs_1
+      structure Time = gs_27
+      structure ULexBuffer = gs_38
+      structure UTF8 = gs_37
+      structure Vector = gs_35
+      structure Word = gs_28
+      structure Word32 = gs_29
+      structure Word64 = gs_30
+      structure Word8 = gs_31
+      structure XMLTokens = gs_34
+      xml-lexer.lex.sml
+   in
+      structure gs_39 = XMLLexer
+   end
+   local
+      signature XML_SCHEMA = gs_0
+      xml-tree-sig.sml
+   in
+      signature gs_40 = XML_TREE
+   end
+   local
+      structure AntlrStreamPos = gs_33
+      structure Char = gs_2
+      structure CharArray = gs_3
+      structure CharVector = gs_4
+      structure FixedInt = gs_5
+      structure General = gs_6
+      structure Int = gs_7
+      structure Int32 = gs_8
+      structure Int64 = gs_9
+      structure IntInf = gs_10
+      structure LargeInt = gs_11
+      structure LargeReal = gs_12
+      structure LargeWord = gs_13
+      structure List = gs_32
+      structure OS = gs_14
+      structure Position = gs_15
+      structure Real = gs_16
+      structure Real64 = gs_17
+      structure RealArray = gs_18
+      structure RealArraySlice = gs_19
+      structure RealVector = gs_20
+      structure RealVectorSlice = gs_21
+      structure SMLofNJ = gs_22
+      structure Socket = gs_23
+      structure String = gs_24
+      structure Substring = gs_25
+      structure SysWord = gs_26
+      structure TextIO = gs_1
+      structure Time = gs_27
+      structure Word = gs_28
+      structure Word32 = gs_29
+      structure Word64 = gs_30
+      structure Word8 = gs_31
+      structure XMLLexer = gs_39
+      structure XMLTokens = gs_34
+      signature XML_TREE = gs_40
+      xml-parser-fn.sml
+   in
+      functor gs_41 = XMLParserFn
+      signature gs_42 = XML_PARSER
+   end
+   local
+      open l78
+   in
+      structure gs_43 = Atom
+   end
+   local
+      signature XML_SCHEMA = gs_0
+      signature XML_TREE = gs_40
+      xml-tree-fn.sml
+   in
+      functor gs_44 = XMLTreeFn
+   end
+   local
+      structure Atom = gs_43
+      structure Char = gs_2
+      structure CharArray = gs_3
+      structure CharVector = gs_4
+      structure FixedInt = gs_5
+      structure General = gs_6
+      structure Int = gs_7
+      structure Int32 = gs_8
+      structure Int64 = gs_9
+      structure IntInf = gs_10
+      structure LargeInt = gs_11
+      structure LargeReal = gs_12
+      structure LargeWord = gs_13
+      structure OS = gs_14
+      structure Position = gs_15
+      structure Real = gs_16
+      structure Real64 = gs_17
+      structure RealArray = gs_18
+      structure RealArraySlice = gs_19
+      structure RealVector = gs_20
+      structure RealVectorSlice = gs_21
+      structure SMLofNJ = gs_22
+      structure Socket = gs_23
+      structure String = gs_24
+      structure Substring = gs_25
+      structure SysWord = gs_26
+      structure Time = gs_27
+      structure Word = gs_28
+      structure Word32 = gs_29
+      structure Word64 = gs_30
+      structure Word8 = gs_31
+      functor XMLTreeFn = gs_44
+      signature XML_TREE = gs_40
+      generic-xml-tree.sml
+   in
+      structure gs_45 = GenericXMLTree
+   end
+in
+   structure GenericXMLTree = gs_45
+   functor XMLParserFn = gs_41
+   functor XMLTreeFn = gs_44
+   signature XML_PARSER = gs_42
+   signature XML_SCHEMA = gs_0
+   signature XML_TREE = gs_40
+end
+end
+
+end
diff --git a/smlnj-lib.mlb b/smlnj-lib.mlb
new file mode 100644
index 0000000..ac130b8
--- /dev/null
+++ b/smlnj-lib.mlb
@@ -0,0 +1,18 @@
+local
+   Controls/controls-lib.mlb
+   HTML/html-lib.mlb
+   HTML4/html4-lib.mlb
+   HashCons/hash-cons-lib.mlb
+   INet/inet-lib.mlb
+   JSON/json-lib.mlb
+   PP/pp-lib.mlb
+   Reactive/reactive-lib.mlb
+   RegExp/regexp-lib.mlb
+   SExp/sexp-lib.mlb
+   Unix/unix-lib.mlb
+   Util/smlnj-lib.mlb
+   Util/time-limit.mlb
+   UUID/uuid-lib.mlb
+   XML/xml-lib.mlb
+in
+end
